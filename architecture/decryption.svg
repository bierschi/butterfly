<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="472px" preserveAspectRatio="none" style="width:951px;height:472px;" version="1.1" viewBox="0 0 951 472" width="951px" zoomAndPan="magnify"><defs><filter height="300%" id="fc42baj2yroly" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fc42baj2yroly)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="264.5" x="675.5" y="264.0938"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="39" x2="39" y1="86.2969" y2="385.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="148" x2="148" y1="86.2969" y2="385.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="276.5" x2="276.5" y1="86.2969" y2="385.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="362.5" x2="362.5" y1="86.2969" y2="385.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="492.5" x2="492.5" y1="86.2969" y2="385.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="623.5" x2="623.5" y1="86.2969" y2="385.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="720.5" x2="720.5" y1="86.2969" y2="385.625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="909" x2="909" y1="86.2969" y2="385.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="82.9951">attacker</text><ellipse cx="39" cy="13" fill="#FEFECE" filter="url(#fc42baj2yroly)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,21 L39,48 M26,29 L52,29 M39,48 L26,63 M39,48 L52,63 " fill="#FEFECE" filter="url(#fc42baj2yroly)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="397.6201">attacker</text><ellipse cx="39" cy="410.9219" fill="#FEFECE" filter="url(#fc42baj2yroly)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,418.9219 L39,445.9219 M26,426.9219 L52,426.9219 M39,445.9219 L26,460.9219 M39,445.9219 L52,460.9219 " fill="#FEFECE" filter="url(#fc42baj2yroly)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="80" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="87" y="70.9951">SPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="80" y="384.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="87" y="404.6201">SPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="253.5" y="82.9951">target</text><ellipse cx="277" cy="13" fill="#FEFECE" filter="url(#fc42baj2yroly)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M277,21 L277,48 M264,29 L290,29 M277,48 L264,63 M277,48 L290,63 " fill="#FEFECE" filter="url(#fc42baj2yroly)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="253.5" y="397.6201">target</text><ellipse cx="277" cy="410.9219" fill="#FEFECE" filter="url(#fc42baj2yroly)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M277,418.9219 L277,445.9219 M264,426.9219 L290,426.9219 M277,445.9219 L264,460.9219 M277,445.9219 L290,460.9219 " fill="#FEFECE" filter="url(#fc42baj2yroly)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="310.5" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="318" y="54.6982">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="317.5" y="70.9951">(embedded)</text><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="310.5" y="384.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="318" y="404.6201">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="317.5" y="420.917">(embedded)</text><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="424.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="431.5" y="70.9951">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="424.5" y="384.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="431.5" y="404.6201">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="571.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="578.5" y="70.9951">CPublic.pem</text><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="571.5" y="384.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="578.5" y="404.6201">CPublic.pem</text><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="685.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="692.5" y="70.9951">AESKey</text><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="685.5" y="384.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="692.5" y="404.6201">AESKey</text><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="889" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="896" y="70.9951">File</text><rect fill="#FEFECE" filter="url(#fc42baj2yroly)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="889" y="384.625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="896" y="404.6201">File</text><polygon fill="#A80036" points="50,113.2969,40,117.2969,50,121.2969,46,117.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="276" y1="117.2969" y2="117.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="56" y="112.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="69" y="112.3638">pay ransom</text><polygon fill="#A80036" points="265,142.4297,275,146.4297,265,150.4297,269,146.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="271" y1="146.4297" y2="146.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="141.4966">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="59" y="141.4966">sends the SPrivateRSA.pem file</text><polygon fill="#A80036" points="481,186.5625,491,190.5625,481,194.5625,485,190.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="277" x2="487" y1="190.5625" y2="190.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="284" y="178.1958">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="297" y="170.6294">decrypt the CPrivateRSA.bin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="301" y="185.7622">with SPrivateRSA.pem</text><polygon fill="#A80036" points="288,215.8281,278,219.8281,288,223.8281,284,219.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="282" x2="492" y1="219.8281" y2="219.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="294" y="214.895">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="307" y="214.895">get CPrivateRSA.pem</text><polygon fill="#A80036" points="708.5,244.9609,718.5,248.9609,708.5,252.9609,712.5,248.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="277" x2="714.5" y1="248.9609" y2="248.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="284" y="244.0278">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="294" x="297" y="244.0278">decrypt the AESKey.bin with CPrivateRSA.pem</text><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="264.5" x="675.5" y="264.0938"/><polygon fill="#EEEEEE" points="675.5,264.0938,752.5,264.0938,752.5,271.0938,742.5,281.0938,675.5,281.0938,675.5,264.0938" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="690.5" y="277.1606">loop</text><polygon fill="#A80036" points="897.5,298.2266,907.5,302.2266,897.5,306.2266,901.5,302.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="720.5" x2="903.5" y1="302.2266" y2="302.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="727.5" y="297.2935">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="740.5" y="297.2935">decrypt file with AESKey</text><polygon fill="#A80036" points="731.5,327.3594,721.5,331.3594,731.5,335.3594,727.5,331.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="725.5" x2="908.5" y1="331.3594" y2="331.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="737.5" y="326.4263">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="750.5" y="326.4263">file.txt</text><polygon fill="#A80036" points="288,363.4922,278,367.4922,288,371.4922,284,367.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="282" x2="908.5" y1="367.4922" y2="367.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="294" y="362.5591">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="307" y="362.5591">Access to all decrypted files</text><!--
@startuml
'https://plantuml.com/sequence-diagram
actor attacker
participant SPrivateRSA.pem as SPrivate
actor target
participant "SPublic.pem\n(embedded)" as SPublic
participant CPrivateRSA.pem as CPrivate
participant CPublic.pem as CPublic
participant AESKey
participant File
autonumber

attacker <- target: pay ransom
attacker -> target: sends the SPrivateRSA.pem file

target -> CPrivate: decrypt the CPrivateRSA.bin\n with SPrivateRSA.pem
CPrivate -> target: get CPrivateRSA.pem
target -> AESKey: decrypt the AESKey.bin with CPrivateRSA.pem
loop
AESKey -> File: decrypt file with AESKey
File -> AESKey: file.txt
end
File -> target: Access to all decrypted files 
@enduml

PlantUML version 1.2017.15(Mon Jul 03 18:45:34 CEST 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.10+9-Ubuntu-0ubuntu1.18.04
Operating System: Linux
OS Version: 5.4.0-67-generic
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>