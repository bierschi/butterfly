<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="567px" preserveAspectRatio="none" style="width:1092px;height:567px;" version="1.1" viewBox="0 0 1092 567" width="1092px" zoomAndPan="magnify"><defs><filter height="300%" id="f1bf8vl59y345n" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1bf8vl59y345n)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="264.5" x="816.5" y="358.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="86.2969" y2="162.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="39" x2="39" y1="162.5625" y2="190.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="190.5625" y2="479.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="148" x2="148" y1="86.2969" y2="162.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="148" x2="148" y1="162.5625" y2="190.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="148" x2="148" y1="190.5625" y2="479.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="349.5" x2="349.5" y1="86.2969" y2="162.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="349.5" x2="349.5" y1="162.5625" y2="190.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="349.5" x2="349.5" y1="190.5625" y2="479.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="435.5" x2="435.5" y1="86.2969" y2="162.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="435.5" x2="435.5" y1="162.5625" y2="190.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="435.5" x2="435.5" y1="190.5625" y2="479.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="633.5" x2="633.5" y1="86.2969" y2="162.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="633.5" x2="633.5" y1="162.5625" y2="190.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="633.5" x2="633.5" y1="190.5625" y2="479.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="764.5" x2="764.5" y1="86.2969" y2="162.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="764.5" x2="764.5" y1="162.5625" y2="190.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="764.5" x2="764.5" y1="190.5625" y2="479.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="861.5" x2="861.5" y1="86.2969" y2="162.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="861.5" x2="861.5" y1="162.5625" y2="190.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="861.5" x2="861.5" y1="190.5625" y2="479.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1050" x2="1050" y1="86.2969" y2="162.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1050" x2="1050" y1="162.5625" y2="190.5625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1050" x2="1050" y1="190.5625" y2="479.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="82.9951">attacker</text><ellipse cx="39" cy="13" fill="#FEFECE" filter="url(#f1bf8vl59y345n)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,21 L39,48 M26,29 L52,29 M39,48 L26,63 M39,48 L52,63 " fill="#FEFECE" filter="url(#f1bf8vl59y345n)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="491.8857">attacker</text><ellipse cx="39" cy="505.1875" fill="#FEFECE" filter="url(#f1bf8vl59y345n)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,513.1875 L39,540.1875 M26,521.1875 L52,521.1875 M39,540.1875 L26,555.1875 M39,540.1875 L52,555.1875 " fill="#FEFECE" filter="url(#f1bf8vl59y345n)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="80" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="87" y="70.9951">SPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="80" y="478.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="87" y="498.8857">SPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="326.5" y="82.9951">target</text><ellipse cx="350" cy="13" fill="#FEFECE" filter="url(#f1bf8vl59y345n)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M350,21 L350,48 M337,29 L363,29 M350,48 L337,63 M350,48 L363,63 " fill="#FEFECE" filter="url(#f1bf8vl59y345n)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="326.5" y="491.8857">target</text><ellipse cx="350" cy="505.1875" fill="#FEFECE" filter="url(#f1bf8vl59y345n)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M350,513.1875 L350,540.1875 M337,521.1875 L363,521.1875 M350,540.1875 L337,555.1875 M350,540.1875 L363,555.1875 " fill="#FEFECE" filter="url(#f1bf8vl59y345n)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="383.5" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="391" y="54.6982">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="390.5" y="70.9951">(embedded)</text><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="383.5" y="478.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="391" y="498.8857">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="390.5" y="515.1826">(embedded)</text><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="565.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="572.5" y="70.9951">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="565.5" y="478.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="572.5" y="498.8857">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="712.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="719.5" y="70.9951">CPublic.pem</text><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="712.5" y="478.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="719.5" y="498.8857">CPublic.pem</text><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="826.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="833.5" y="70.9951">AESKey</text><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="826.5" y="478.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="833.5" y="498.8857">AESKey</text><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1030" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1037" y="70.9951">File</text><rect fill="#FEFECE" filter="url(#f1bf8vl59y345n)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1030" y="478.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1037" y="498.8857">File</text><polygon fill="#FBFB77" filter="url(#f1bf8vl59y345n)" points="100,101.2969,482,101.2969,492,112.2969,482,124.2969,100,124.2969,90,112.2969,100,101.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="177.75" y="117.3638">server rsa key pair (keysize: 13768)</text><polygon fill="#FBFB77" filter="url(#f1bf8vl59y345n)" points="586,134.4297,812,134.4297,822,145.4297,812,157.4297,586,157.4297,576,145.4297,586,134.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="592.5" y="150.4966">client rsa key pair (keysize: 2048)</text><polygon fill="#A80036" points="50,207.5625,40,211.5625,50,215.5625,46,211.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="349" y1="211.5625" y2="211.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="56" y="206.6294">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="69" y="206.6294">target pays ransom</text><polygon fill="#A80036" points="338,236.6953,348,240.6953,338,244.6953,342,240.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="344" y1="240.6953" y2="240.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="235.7622">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="59" y="235.7622">attacker sends the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="183" y="235.7622">SPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="18" x="315" y="235.7622">file</text><polygon fill="#A80036" points="622,280.8281,632,284.8281,622,288.8281,626,284.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="628" y1="284.8281" y2="284.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="357" y="272.4614">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="370" y="264.895">decrypt the CPrivateRSA.bin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="374" y="280.0278">with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="403" y="280.0278">SPrivateRSA.pem</text><polygon fill="#A80036" points="361,310.0938,351,314.0938,361,318.0938,357,314.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="633" y1="314.0938" y2="314.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="367" y="309.1606">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="380" y="309.1606">get the decrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="498" y="309.1606">CPrivateRSA.pem</text><polygon fill="#A80036" points="849.5,339.2266,859.5,343.2266,849.5,347.2266,853.5,343.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="350" x2="855.5" y1="343.2266" y2="343.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="357" y="338.2935">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="370" y="338.2935">decrypt the AESKey.bin with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="552" y="338.2935">CPrivateRSA.pem</text><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="264.5" x="816.5" y="358.3594"/><polygon fill="#EEEEEE" points="816.5,358.3594,893.5,358.3594,893.5,365.3594,883.5,375.3594,816.5,375.3594,816.5,358.3594" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="831.5" y="371.4263">loop</text><polygon fill="#A80036" points="1038.5,392.4922,1048.5,396.4922,1038.5,400.4922,1042.5,396.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="861.5" x2="1044.5" y1="396.4922" y2="396.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="868.5" y="391.5591">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="881.5" y="391.5591">decrypt file with AESKey</text><polygon fill="#A80036" points="872.5,421.625,862.5,425.625,872.5,429.625,868.5,425.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="866.5" x2="1049.5" y1="425.625" y2="425.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="878.5" y="420.6919">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="891.5" y="420.6919">file.txt</text><polygon fill="#A80036" points="361,457.7578,351,461.7578,361,465.7578,357,461.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="1049.5" y1="461.7578" y2="461.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="367" y="456.8247">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="285" x="380" y="456.8247">target has again access to all decrypted files</text><!--
@startuml
'https://plantuml.com/sequence-diagram
actor attacker
participant SPrivateRSA.pem as SPrivate
actor target
participant "SPublic.pem\n(embedded)" as SPublic
participant CPrivateRSA.pem as CPrivate
participant CPublic.pem as CPublic
participant AESKey
participant File

autonumber
hnote over SPrivate, SPublic: server rsa key pair (keysize: 13768)
hnote over CPrivate, CPublic: client rsa key pair (keysize: 2048)
...
attacker <- target: target pays ransom
attacker -> target: attacker sends the **SPrivateRSA.pem** file

target -> CPrivate: decrypt the CPrivateRSA.bin\n with **SPrivateRSA.pem**
CPrivate -> target: get the decrypted **CPrivateRSA.pem**
target -> AESKey: decrypt the AESKey.bin with **CPrivateRSA.pem**
loop
AESKey -> File: decrypt file with AESKey
File -> AESKey: file.txt
end
File -> target: target has again access to all decrypted files
@enduml

PlantUML version 1.2017.15(Mon Jul 03 18:45:34 CEST 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.10+9-Ubuntu-0ubuntu1.18.04
Operating System: Linux
OS Version: 5.4.0-67-generic
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>