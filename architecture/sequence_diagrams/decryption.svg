<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="644px" preserveAspectRatio="none" style="width:1368px;height:644px;" version="1.1" viewBox="0 0 1368 644" width="1368px" zoomAndPan="magnify"><defs><filter height="300%" id="f34znt6hs0mst" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f34znt6hs0mst)" height="114.5313" style="stroke: #000000; stroke-width: 2.0;" width="436" x="921.5" y="396.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="86.2969" y2="195.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="39" x2="39" y1="195.6953" y2="223.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="223.6953" y2="557.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="148" x2="148" y1="86.2969" y2="195.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="148" x2="148" y1="195.6953" y2="223.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="148" x2="148" y1="223.6953" y2="557.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="522.5" x2="522.5" y1="86.2969" y2="195.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="522.5" x2="522.5" y1="195.6953" y2="223.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="522.5" x2="522.5" y1="223.6953" y2="557.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="608.5" x2="608.5" y1="86.2969" y2="195.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="608.5" x2="608.5" y1="195.6953" y2="223.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="608.5" x2="608.5" y1="223.6953" y2="557.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="738.5" x2="738.5" y1="86.2969" y2="195.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="738.5" x2="738.5" y1="195.6953" y2="223.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="738.5" x2="738.5" y1="223.6953" y2="557.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="869.5" x2="869.5" y1="86.2969" y2="195.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="869.5" x2="869.5" y1="195.6953" y2="223.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="869.5" x2="869.5" y1="223.6953" y2="557.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="988.5" x2="988.5" y1="86.2969" y2="195.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="988.5" x2="988.5" y1="195.6953" y2="223.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="988.5" x2="988.5" y1="223.6953" y2="557.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1280" x2="1280" y1="86.2969" y2="195.6953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1280" x2="1280" y1="195.6953" y2="223.6953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1280" x2="1280" y1="223.6953" y2="557.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="82.9951">attacker</text><ellipse cx="39" cy="13" fill="#FEFECE" filter="url(#f34znt6hs0mst)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,21 L39,48 M26,29 L52,29 M39,48 L26,63 M39,48 L52,63 " fill="none" filter="url(#f34znt6hs0mst)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="569.0186">attacker</text><ellipse cx="39" cy="582.3203" fill="#FEFECE" filter="url(#f34znt6hs0mst)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,590.3203 L39,617.3203 M26,598.3203 L52,598.3203 M39,617.3203 L26,632.3203 M39,617.3203 L52,632.3203 " fill="none" filter="url(#f34znt6hs0mst)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="80" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="87" y="70.9951">SPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="80" y="556.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="87" y="576.0186">SPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="499.5" y="82.9951">target</text><ellipse cx="523" cy="13" fill="#FEFECE" filter="url(#f34znt6hs0mst)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M523,21 L523,48 M510,29 L536,29 M523,48 L510,63 M523,48 L536,63 " fill="none" filter="url(#f34znt6hs0mst)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="499.5" y="569.0186">target</text><ellipse cx="523" cy="582.3203" fill="#FEFECE" filter="url(#f34znt6hs0mst)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M523,590.3203 L523,617.3203 M510,598.3203 L536,598.3203 M523,617.3203 L510,632.3203 M523,617.3203 L536,632.3203 " fill="none" filter="url(#f34znt6hs0mst)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="556.5" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="54.6982">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="563.5" y="70.9951">(embedded)</text><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="556.5" y="556.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="576.0186">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="563.5" y="592.3154">(embedded)</text><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="670.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="677.5" y="70.9951">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="670.5" y="556.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="677.5" y="576.0186">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="817.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="824.5" y="70.9951">CPublic.pem</text><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="817.5" y="556.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="824.5" y="576.0186">CPublic.pem</text><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="110" x="931.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="96" x="938.5" y="70.9951">AESKey/AESIV</text><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="110" x="931.5" y="556.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="96" x="938.5" y="576.0186">AESKey/AESIV</text><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1260" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1267" y="70.9951">File</text><rect fill="#FEFECE" filter="url(#f34znt6hs0mst)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1260" y="556.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1267" y="576.0186">File</text><polygon fill="#FBFB77" filter="url(#f34znt6hs0mst)" points="100,101.2969,655,101.2969,665,112.2969,655,124.2969,100,124.2969,90,112.2969,100,101.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="251.75" y="117.3638">Server RSA Key pair (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="387.75" y="117.3638">Keysize: 13768</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="498.75" y="117.3638">)</text><polygon fill="#FBFB77" filter="url(#f34znt6hs0mst)" points="683,134.4297,924,134.4297,934,145.4297,924,157.4297,683,157.4297,673,145.4297,683,134.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="685" y="150.4966">Client RSA Key pair (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="815" y="150.4966">Keysize: 2048</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="917" y="150.4966">)</text><polygon fill="#FBFB77" filter="url(#f34znt6hs0mst)" points="890,167.5625,1087,167.5625,1097,178.5625,1087,190.5625,890,190.5625,880,178.5625,890,167.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="892" y="183.6294">256-Bit-AESKey/128-Bit-AESIV</text><polygon fill="#A80036" points="50,240.8281,40,244.8281,50,248.8281,46,244.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="522" y1="244.8281" y2="244.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="56" y="239.7622">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="69" y="239.7622">target pays ransom</text><polygon fill="#A80036" points="511,269.9609,521,273.9609,511,277.9609,515,273.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="517" y1="273.9609" y2="273.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="268.895">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="59" y="268.895">attacker accepts ransom payment</text><polygon fill="#A80036" points="50,299.0938,40,303.0938,50,307.0938,46,303.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="522" y1="303.0938" y2="303.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="56" y="298.0278">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="69" y="298.0278">Send</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="106" y="298.0278">CPrivateRSA.bin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="229" y="298.0278">file to bflyServerApp</text><polygon fill="#A80036" points="511,333.2266,521,337.2266,511,341.2266,515,337.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="517" y1="337.2266" y2="337.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="332.1606">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="59" y="332.1606">bflyServerApp responds with the decrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="337" y="332.1606">CPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="470" y="332.1606">string</text><path d="M528,316.0938 L528,341.0938 L678,341.0938 L678,326.0938 L668,316.0938 L528,316.0938 " fill="#FBFB77" filter="url(#f34znt6hs0mst)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M668,316.0938 L668,326.0938 L678,326.0938 L668,316.0938 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="534" y="333.1606">CPrivateRSA.pem</text><polygon fill="#A80036" points="976.5,372.3594,986.5,376.3594,976.5,380.3594,980.5,376.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="523" x2="982.5" y1="376.3594" y2="376.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="530" y="371.2935">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="543" y="371.2935">decrypt the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="620" y="371.2935">AES.bin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="680" y="371.2935">with the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="734" y="371.2935">CPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="867" y="371.2935">string</text><path d="M993,355.2266 L993,380.2266 L1228,380.2266 L1228,365.2266 L1218,355.2266 L993,355.2266 " fill="#FBFB77" filter="url(#f34znt6hs0mst)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1218,355.2266 L1218,365.2266 L1228,365.2266 L1218,355.2266 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="214" x="999" y="372.2935">AESKeyPair(AESKey &amp; AESIV)</text><path d="M921.5,396.3594 L998.5,396.3594 L998.5,403.3594 L988.5,413.3594 L921.5,413.3594 L921.5,396.3594 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="114.5313" style="stroke: #000000; stroke-width: 2.0;" width="436" x="921.5" y="396.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="936.5" y="409.4263">loop</text><polygon fill="#A80036" points="1268.5,430.625,1278.5,434.625,1268.5,438.625,1272.5,434.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="988.5" x2="1274.5" y1="434.625" y2="434.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="995.5" y="429.5591">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="1008.5" y="429.5591">get file with butterfly ending</text><polygon fill="#A80036" points="999.5,459.7578,989.5,463.7578,999.5,467.7578,995.5,463.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="993.5" x2="1279.5" y1="463.7578" y2="463.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1005.5" y="458.6919">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="1018.5" y="458.6919">decrypt</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="1070.5" y="458.6919">*.bfly</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="1114.5" y="458.6919">file with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="1165.5" y="458.6919">AESKey&amp;AESIV</text><polygon fill="#A80036" points="1268.5,493.8906,1278.5,497.8906,1268.5,501.8906,1272.5,497.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="988.5" x2="1274.5" y1="497.8906" y2="497.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="995.5" y="492.8247">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="1008.5" y="492.8247">get original file</text><path d="M1285,476.7578 L1285,501.7578 L1338,501.7578 L1338,486.7578 L1328,476.7578 L1285,476.7578 " fill="#FBFB77" filter="url(#f34znt6hs0mst)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1328,476.7578 L1328,486.7578 L1338,486.7578 L1328,476.7578 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="1291" y="493.8247">*.txt</text><polygon fill="#A80036" points="534,535.0234,524,539.0234,534,543.0234,530,539.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="528" x2="1279.5" y1="539.0234" y2="539.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="540" y="533.9575">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="553" y="533.9575">target has again access to all user files</text><!--
@startuml

actor attacker
participant SPrivateRSA.pem as SPrivate
actor target
participant "SPublic.pem\n(embedded)" as SPublic
participant CPrivateRSA.pem as CPrivate
participant CPublic.pem as CPublic
participant "AESKey/AESIV" as AESKey
participant File

autonumber
hnote over SPrivate, SPublic: Server RSA Key pair (**Keysize: 13768**)
hnote over CPrivate, CPublic: Client RSA Key pair (**Keysize: 2048**)
hnote over AESKey: 256-Bit-AESKey/128-Bit-AESIV
...
attacker <- target: target pays ransom
attacker -> target: attacker accepts ransom payment
attacker <- target: Send **CPrivateRSA.bin** file to bflyServerApp
attacker -> target: bflyServerApp responds with the decrypted **CPrivateRSA.pem** string
note right: **CPrivateRSA.pem**

target -> AESKey: decrypt the **AES.bin** with the **CPrivateRSA.pem** string
note right: **AESKeyPair(AESKey & AESIV)**

loop
File <- AESKey: get file with butterfly ending
File -> AESKey: decrypt ***.bfly** file with **AESKey&AESIV**
File <- AESKey: get original file
note right: **~*.txt**
end
File -> target: target has again access to all user files

@enduml

PlantUML version 1.2018.13(Mon Nov 26 18:11:51 CET 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.13+8-Ubuntu-0ubuntu1.20.04
Operating System: Linux
OS Version: 5.13.0-27-generic
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>