<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="757px" preserveAspectRatio="none" style="width:1748px;height:757px;" version="1.1" viewBox="0 0 1748 757" width="1748px" zoomAndPan="magnify"><defs><filter height="300%" id="fwx6rtvjm0woy" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fwx6rtvjm0woy)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="1456" x="281.5" y="457.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="39" x2="39" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="280.9609" y2="670.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179" x2="179" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="179" x2="179" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179" x2="179" y1="280.9609" y2="670.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="314.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="314.5" x2="314.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="314.5" y1="280.9609" y2="670.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="542" x2="542" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="542" x2="542" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="542" x2="542" y1="280.9609" y2="670.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="683.5" x2="683.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="683.5" x2="683.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="683.5" x2="683.5" y1="280.9609" y2="670.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="814.5" x2="814.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="814.5" x2="814.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="814.5" x2="814.5" y1="280.9609" y2="670.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1111.5" x2="1111.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1111.5" x2="1111.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1111.5" x2="1111.5" y1="280.9609" y2="670.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1652" x2="1652" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1652" x2="1652" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1652" x2="1652" y1="280.9609" y2="670.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="82.9951">attacker</text><ellipse cx="39" cy="13" fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,21 L39,48 M26,29 L52,29 M39,48 L26,63 M39,48 L52,63 " fill="none" filter="url(#fwx6rtvjm0woy)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="682.5498">attacker</text><ellipse cx="39" cy="695.8516" fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,703.8516 L39,730.8516 M26,711.8516 L52,711.8516 M39,730.8516 L26,745.8516 M39,730.8516 L52,745.8516 " fill="none" filter="url(#fwx6rtvjm0woy)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="111" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="118" y="70.9951">SPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="111" y="669.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="118" y="689.5498">SPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="291.5" y="82.9951">target</text><ellipse cx="315" cy="13" fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M315,21 L315,48 M302,29 L328,29 M315,48 L302,63 M315,48 L328,63 " fill="none" filter="url(#fwx6rtvjm0woy)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="291.5" y="682.5498">target</text><ellipse cx="315" cy="695.8516" fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M315,703.8516 L315,730.8516 M302,711.8516 L328,711.8516 M315,730.8516 L302,745.8516 M315,730.8516 L328,745.8516 " fill="none" filter="url(#fwx6rtvjm0woy)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="490" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="497.5" y="54.6982">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="497" y="70.9951">(embedded)</text><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="490" y="669.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="497.5" y="689.5498">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="497" y="705.8467">(embedded)</text><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="615.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="622.5" y="70.9951">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="615.5" y="669.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="622.5" y="689.5498">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="762.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="769.5" y="70.9951">CPublic.pem</text><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="762.5" y="669.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="769.5" y="689.5498">CPublic.pem</text><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1055.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1062.5" y="70.9951">AESKey/AESIv</text><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="1055.5" y="669.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="1062.5" y="689.5498">AESKey/AESIv</text><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1632" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1639" y="70.9951">File</text><rect fill="#FEFECE" filter="url(#fwx6rtvjm0woy)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1632" y="669.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1639" y="689.5498">File</text><polygon fill="#FBFB77" filter="url(#fwx6rtvjm0woy)" points="131,101.2969,589,101.2969,599,112.2969,589,124.2969,131,124.2969,121,112.2969,131,101.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="246.5" y="117.3638">server rsa key pair (keysize: 13768)</text><polygon fill="#FBFB77" filter="url(#fwx6rtvjm0woy)" points="636,134.4297,862,134.4297,872,145.4297,862,157.4297,636,157.4297,626,145.4297,636,134.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="642.5" y="150.4966">client rsa key pair (keysize: 2048)</text><polygon fill="#FBFB77" filter="url(#fwx6rtvjm0woy)" points="1014,167.5625,1209,167.5625,1219,178.5625,1209,190.5625,1014,190.5625,1004,178.5625,1014,167.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="1016" y="183.6294">256-Bit-AESKey/128-Bit-AESIv</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="81" y1="231.9609" y2="231.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="81" x2="81" y1="231.9609" y2="244.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40" x2="81" y1="244.9609" y2="244.9609"/><polygon fill="#A80036" points="50,240.9609,40,244.9609,50,248.9609,46,244.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="219.3286">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="59" y="211.7622">generate the RSA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="63" y="226.895">server key pair</text><polygon fill="#A80036" points="303,298.0938,313,302.0938,303,306.0938,307,302.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="309" y1="302.0938" y2="302.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="297.0278">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="59" y="297.0278">compromise the target host machine</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="357" y1="346.3594" y2="346.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="357" x2="357" y1="346.3594" y2="359.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="357" y1="359.3594" y2="359.3594"/><polygon fill="#A80036" points="326,355.3594,316,359.3594,326,363.3594,322,359.3594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="333.7271">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="335" y="326.1606">generate an infection specific</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="339" y="341.2935">client RSA key pair</text><polygon fill="#A80036" points="672,399.625,682,403.625,672,407.625,676,403.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="678" y1="403.625" y2="403.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="390.9927">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="335" y="383.4263">encrypt the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="412" y="383.4263">CPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="545" y="383.4263">with the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="339" y="398.5591">embedded</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="412" y="398.5591">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="508" y="398.5591">in the ransomware</text><polygon fill="#A80036" points="326,433.7578,316,437.7578,326,441.7578,322,437.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="320" x2="683" y1="437.7578" y2="437.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="332" y="432.6919">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="345" y="432.6919">save</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="379" y="432.6919">CPrivateRSA.bin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="502" y="432.6919">on the target host machine</text><path d="M166,416.625 L166,441.625 L306,441.625 L306,426.625 L296,416.625 L166,416.625 " fill="#FBFB77" filter="url(#fwx6rtvjm0woy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M296,416.625 L296,426.625 L306,426.625 L296,416.625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="172" y="433.6919">CPrivateRSA.bin</text><path d="M281.5,457.7578 L358.5,457.7578 L358.5,464.7578 L348.5,474.7578 L281.5,474.7578 L281.5,457.7578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="1456" x="281.5" y="457.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="296.5" y="470.8247">loop</text><polygon fill="#A80036" points="1099.5,492.0234,1109.5,496.0234,1099.5,500.0234,1103.5,496.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="1105.5" y1="496.0234" y2="496.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="490.9575">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="387" x="335" y="490.9575">generate for each file a new 256-Bit-AESKey &amp; 128-Bit-AESIv</text><polygon fill="#A80036" points="1640.5,526.1563,1650.5,530.1563,1640.5,534.1563,1644.5,530.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1111.5" x2="1646.5" y1="530.1563" y2="530.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1118.5" y="525.0903">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="504" x="1131.5" y="525.0903">encrypt file with 256-Bit-AESKey &amp; 128-Bit-AESIv and save with butterfly ending</text><path d="M1657,509.0234 L1657,534.0234 L1718,534.0234 L1718,519.0234 L1708,509.0234 L1657,509.0234 " fill="#FBFB77" filter="url(#fwx6rtvjm0woy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1708,509.0234 L1708,519.0234 L1718,519.0234 L1708,509.0234 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="1663" y="526.0903">*.bfly</text><polygon fill="#A80036" points="1099.5,567.2891,1109.5,571.2891,1099.5,575.2891,1103.5,571.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="814.5" x2="1105.5" y1="571.2891" y2="571.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="821.5" y="566.2231">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="260" x="834.5" y="566.2231">encrypt AESKey&amp;AESIv with CPublic.pem</text><polygon fill="#A80036" points="326,601.4219,316,605.4219,326,609.4219,322,605.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="320" x2="1110.5" y1="605.4219" y2="605.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="332" y="600.356">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="345" y="600.356">save</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="379" y="600.356">AESKey.bin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="11" x="466" y="600.356">&amp;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="70" x="481" y="600.356">AESIV.bin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="555" y="600.356">on the target host machine</text><path d="M111,584.2891 L111,609.2891 L306,609.2891 L306,594.2891 L296,584.2891 L111,584.2891 " fill="#FBFB77" filter="url(#fwx6rtvjm0woy)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M296,584.2891 L296,594.2891 L306,594.2891 L296,584.2891 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="174" x="117" y="601.356">AESKey.bin &amp; AESIV.bin</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="357" y1="639.5547" y2="639.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="357" x2="357" y1="639.5547" y2="652.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="357" y1="652.5547" y2="652.5547"/><polygon fill="#A80036" points="326,648.5547,316,652.5547,326,656.5547,322,652.5547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="322" y="634.4888">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="344" y="634.4888">display ransom payment note</text><!--
@startuml

actor attacker
participant SPrivateRSA.pem as SPrivate
actor target
participant "SPublic.pem\n(embedded)" as SPublic
participant CPrivateRSA.pem as CPrivate
participant CPublic.pem as CPublic
participant "AESKey/AESIv" as AESKey
participant File

autonumber
hnote over SPrivate, SPublic: server rsa key pair (keysize: 13768)
hnote over CPrivate, CPublic: client rsa key pair (keysize: 2048)
hnote over AESKey: 256-Bit-AESKey/128-Bit-AESIv
attacker -> attacker: generate the RSA\n server key pair
...
attacker -> target: compromise the target host machine
target -> target: generate an infection specific\n client RSA key pair
target -> CPrivate: encrypt the **CPrivateRSA.pem** with the\n embedded **SPublic.pem** in the ransomware
CPrivate -> target: save **CPrivateRSA.bin** on the target host machine
note left: **CPrivateRSA.bin**
loop
target -> AESKey: generate for each file a new 256-Bit-AESKey & 128-Bit-AESIv
AESKey -> File: encrypt file with 256-Bit-AESKey & 128-Bit-AESIv and save with butterfly ending
note right: **~*.bfly**

end

CPublic -> AESKey: encrypt AESKey&AESIv with CPublic.pem
AESKey -> target: save **AESKey.bin** & **AESIV.bin** on the target host machine
note left: **AESKey.bin & AESIV.bin**

target -> target: display ransom payment note

@enduml

PlantUML version 1.2018.13(Mon Nov 26 18:11:51 CET 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.11+9-Ubuntu-0ubuntu2.20.04
Operating System: Linux
OS Version: 5.11.0-27-generic
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>