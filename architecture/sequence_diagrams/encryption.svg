<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="807px" preserveAspectRatio="none" style="width:1424px;height:807px;" version="1.1" viewBox="0 0 1424 807" width="1424px" zoomAndPan="magnify"><defs><filter height="300%" id="f1fpgww3lxklgw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1fpgww3lxklgw)" height="90.5313" style="stroke: #000000; stroke-width: 2.0;" width="1132" x="281.5" y="457.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="39" x2="39" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="280.9609" y2="719.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179" x2="179" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="179" x2="179" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179" x2="179" y1="280.9609" y2="719.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="314.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="314.5" x2="314.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="314.5" y1="280.9609" y2="719.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="542" x2="542" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="542" x2="542" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="542" x2="542" y1="280.9609" y2="719.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="683.5" x2="683.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="683.5" x2="683.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="683.5" x2="683.5" y1="280.9609" y2="719.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="814.5" x2="814.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="814.5" x2="814.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="814.5" x2="814.5" y1="280.9609" y2="719.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="980.5" x2="980.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="980.5" x2="980.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="980.5" x2="980.5" y1="280.9609" y2="719.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1328" x2="1328" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1328" x2="1328" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1328" x2="1328" y1="280.9609" y2="719.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="82.9951">attacker</text><ellipse cx="39" cy="13" fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,21 L39,48 M26,29 L52,29 M39,48 L26,63 M39,48 L52,63 " fill="none" filter="url(#f1fpgww3lxklgw)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="731.9482">attacker</text><ellipse cx="39" cy="745.25" fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,753.25 L39,780.25 M26,761.25 L52,761.25 M39,780.25 L26,795.25 M39,780.25 L52,795.25 " fill="none" filter="url(#f1fpgww3lxklgw)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="111" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="118" y="70.9951">SPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="111" y="718.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="118" y="738.9482">SPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="291.5" y="82.9951">target</text><ellipse cx="315" cy="13" fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M315,21 L315,48 M302,29 L328,29 M315,48 L302,63 M315,48 L328,63 " fill="none" filter="url(#f1fpgww3lxklgw)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="291.5" y="731.9482">target</text><ellipse cx="315" cy="745.25" fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M315,753.25 L315,780.25 M302,761.25 L328,761.25 M315,780.25 L302,795.25 M315,780.25 L328,795.25 " fill="none" filter="url(#f1fpgww3lxklgw)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="490" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="497.5" y="54.6982">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="497" y="70.9951">(embedded)</text><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="490" y="718.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="497.5" y="738.9482">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="497" y="755.2451">(embedded)</text><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="615.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="622.5" y="70.9951">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="615.5" y="718.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="622.5" y="738.9482">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="762.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="769.5" y="70.9951">CPublic.pem</text><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="762.5" y="718.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="769.5" y="738.9482">CPublic.pem</text><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="110" x="923.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="96" x="930.5" y="70.9951">AESKey/AESIV</text><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="110" x="923.5" y="718.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="96" x="930.5" y="738.9482">AESKey/AESIV</text><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1308" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1315" y="70.9951">File</text><rect fill="#FEFECE" filter="url(#f1fpgww3lxklgw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1308" y="718.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1315" y="738.9482">File</text><polygon fill="#FBFB77" filter="url(#f1fpgww3lxklgw)" points="131,101.2969,589,101.2969,599,112.2969,589,124.2969,131,124.2969,121,112.2969,131,101.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="234" y="117.3638">Server RSA Key pair (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="370" y="117.3638">Keysize: 13768</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="481" y="117.3638">)</text><polygon fill="#FBFB77" filter="url(#f1fpgww3lxklgw)" points="628,134.4297,869,134.4297,879,145.4297,869,157.4297,628,157.4297,618,145.4297,628,134.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="630" y="150.4966">Client RSA Key pair (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="102" x="760" y="150.4966">Keysize: 2048</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="862" y="150.4966">)</text><polygon fill="#FBFB77" filter="url(#f1fpgww3lxklgw)" points="882,167.5625,1079,167.5625,1089,178.5625,1079,190.5625,882,190.5625,872,178.5625,882,167.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="884" y="183.6294">256-Bit-AESKey/128-Bit-AESIV</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="81" y1="231.9609" y2="231.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="81" x2="81" y1="231.9609" y2="244.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40" x2="81" y1="244.9609" y2="244.9609"/><polygon fill="#A80036" points="50,240.9609,40,244.9609,50,248.9609,46,244.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="219.3286">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="59" y="211.7622">generate the RSA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="63" y="226.895">server key pair</text><polygon fill="#A80036" points="303,298.0938,313,302.0938,303,306.0938,307,302.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="309" y1="302.0938" y2="302.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="297.0278">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="59" y="297.0278">compromise the target host machine</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="357" y1="346.3594" y2="346.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="357" x2="357" y1="346.3594" y2="359.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="357" y1="359.3594" y2="359.3594"/><polygon fill="#A80036" points="326,355.3594,316,359.3594,326,363.3594,322,359.3594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="333.7271">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="335" y="326.1606">generate an infection specific</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="339" y="341.2935">client RSA key pair</text><polygon fill="#A80036" points="672,399.625,682,403.625,672,407.625,676,403.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="678" y1="403.625" y2="403.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="390.9927">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="335" y="383.4263">encrypt the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="412" y="383.4263">CPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="545" y="383.4263">with the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="339" y="398.5591">embedded</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="412" y="398.5591">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="508" y="398.5591">in the ransomware</text><polygon fill="#A80036" points="326,433.7578,316,437.7578,326,441.7578,322,437.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="320" x2="683" y1="437.7578" y2="437.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="332" y="432.6919">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="345" y="432.6919">save</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="379" y="432.6919">CPrivateRSA.bin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="502" y="432.6919">on the target host machine</text><path d="M166,416.625 L166,441.625 L306,441.625 L306,426.625 L296,416.625 L166,416.625 " fill="#FBFB77" filter="url(#f1fpgww3lxklgw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M296,416.625 L296,426.625 L306,426.625 L296,416.625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="172" y="433.6919">CPrivateRSA.bin</text><path d="M281.5,457.7578 L358.5,457.7578 L358.5,464.7578 L348.5,474.7578 L281.5,474.7578 L281.5,457.7578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.5313" style="stroke: #000000; stroke-width: 2.0;" width="1132" x="281.5" y="457.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="296.5" y="470.8247">loop</text><polygon fill="#A80036" points="968.5,492.0234,978.5,496.0234,968.5,500.0234,972.5,496.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="974.5" y1="496.0234" y2="496.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="490.9575">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="414" x="335" y="490.9575">generate a random 256-Bit-AESKey and 128-Bit-AESIV with SALT</text><polygon fill="#A80036" points="1316.5,536.2891,1326.5,540.2891,1316.5,544.2891,1320.5,540.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="980.5" x2="1322.5" y1="540.2891" y2="540.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="987.5" y="527.6567">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="311" x="1000.5" y="520.0903">encrypt file with 256-Bit-AESKey &amp; 128-Bit-AESIV</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="1004.5" y="535.2231">and save with butterfly ending</text><path d="M1333,511.5898 L1333,536.5898 L1394,536.5898 L1394,521.5898 L1384,511.5898 L1333,511.5898 " fill="#FBFB77" filter="url(#f1fpgww3lxklgw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1384,511.5898 L1384,521.5898 L1394,521.5898 L1384,511.5898 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="1339" y="528.6567">*.bfly</text><polygon fill="#A80036" points="991.5,572.4219,981.5,576.4219,991.5,580.4219,987.5,576.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="985.5" x2="1327.5" y1="576.4219" y2="576.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="997.5" y="571.356">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="278" x="1010.5" y="571.356">Concatenate AESKey&amp;AESIV to AESKeyPair</text><polygon fill="#A80036" points="825.5,616.6875,815.5,620.6875,825.5,624.6875,821.5,620.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="819.5" x2="979.5" y1="620.6875" y2="620.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="831.5" y="608.0552">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="844.5" y="600.4888">encrypt AESKeyPair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="844.5" y="615.6216">with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="873.5" y="615.6216">CPublic.pem</text><polygon fill="#A80036" points="326,650.8203,316,654.8203,326,658.8203,322,654.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="320" x2="813.5" y1="654.8203" y2="654.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="332" y="649.7544">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="354" y="649.7544">save</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="388" y="649.7544">AES.bin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="448" y="649.7544">on the target host machine</text><path d="M229,633.6875 L229,658.6875 L306,658.6875 L306,643.6875 L296,633.6875 L229,633.6875 " fill="#FBFB77" filter="url(#f1fpgww3lxklgw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M296,633.6875 L296,643.6875 L306,643.6875 L296,633.6875 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="235" y="650.7544">AES.bin</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="357" y1="688.9531" y2="688.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="357" x2="357" y1="688.9531" y2="701.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="357" y1="701.9531" y2="701.9531"/><polygon fill="#A80036" points="326,697.9531,316,701.9531,326,705.9531,322,701.9531" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="322" y="683.8872">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="344" y="683.8872">display ransom payment note</text><!--
@startuml

actor attacker
participant SPrivateRSA.pem as SPrivate
actor target
participant "SPublic.pem\n(embedded)" as SPublic
participant CPrivateRSA.pem as CPrivate
participant CPublic.pem as CPublic
participant "AESKey/AESIV" as AESKey
participant File

autonumber
hnote over SPrivate, SPublic: Server RSA Key pair (**Keysize: 13768**)
hnote over CPrivate, CPublic: Client RSA Key pair (**Keysize: 2048**)
hnote over AESKey: 256-Bit-AESKey/128-Bit-AESIV
attacker -> attacker: generate the RSA\n server key pair
...
attacker -> target: compromise the target host machine
target -> target: generate an infection specific\n client RSA key pair
target -> CPrivate: encrypt the **CPrivateRSA.pem** with the\n embedded **SPublic.pem** in the ransomware
CPrivate -> target: save **CPrivateRSA.bin** on the target host machine
note left: **CPrivateRSA.bin**
loop
target -> AESKey: generate a random 256-Bit-AESKey and 128-Bit-AESIV with SALT
AESKey -> File: encrypt file with 256-Bit-AESKey & 128-Bit-AESIV\n and save with butterfly ending
note right: **~*.bfly**

end

File->AESKey: Concatenate AESKey&AESIV to AESKeyPair
AESKey -> CPublic: encrypt AESKeyPair \nwith **CPublic.pem**
CPublic -> target: save **AES.bin** on the target host machine
note left: **AES.bin**

target -> target: display ransom payment note

@enduml

PlantUML version 1.2018.13(Mon Nov 26 18:11:51 CET 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.11+9-Ubuntu-0ubuntu2.20.04
Operating System: Linux
OS Version: 5.11.0-34-generic
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>