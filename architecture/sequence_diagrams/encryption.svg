<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="786px" preserveAspectRatio="none" style="width:1866px;height:786px;" version="1.1" viewBox="0 0 1866 786" width="1866px" zoomAndPan="magnify"><defs><filter height="300%" id="flmeziw9jxx4t" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#flmeziw9jxx4t)" height="114.5313" style="stroke: #000000; stroke-width: 2.0;" width="1574" x="281.5" y="457.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="39" x2="39" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="280.9609" y2="699.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179" x2="179" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="179" x2="179" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179" x2="179" y1="280.9609" y2="699.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="314.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="314.5" x2="314.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="314.5" y1="280.9609" y2="699.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="542" x2="542" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="542" x2="542" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="542" x2="542" y1="280.9609" y2="699.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="672" x2="672" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="672" x2="672" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="672" x2="672" y1="280.9609" y2="699.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="803" x2="803" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="803" x2="803" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="803" x2="803" y1="280.9609" y2="699.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921" x2="921" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="921" x2="921" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921" x2="921" y1="280.9609" y2="699.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1355.5" x2="1355.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1355.5" x2="1355.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1355.5" x2="1355.5" y1="280.9609" y2="699.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1784.5" x2="1784.5" y1="86.2969" y2="252.9609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1784.5" x2="1784.5" y1="252.9609" y2="280.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1784.5" x2="1784.5" y1="280.9609" y2="699.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="82.9951">attacker</text><ellipse cx="39" cy="13" fill="#FEFECE" filter="url(#flmeziw9jxx4t)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,21 L39,48 M26,29 L52,29 M39,48 L26,63 M39,48 L52,63 " fill="none" filter="url(#flmeziw9jxx4t)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="711.6826">attacker</text><ellipse cx="39" cy="724.9844" fill="#FEFECE" filter="url(#flmeziw9jxx4t)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,732.9844 L39,759.9844 M26,740.9844 L52,740.9844 M39,759.9844 L26,774.9844 M39,759.9844 L52,774.9844 " fill="none" filter="url(#flmeziw9jxx4t)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="111" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="118" y="70.9951">SPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="111" y="698.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="118" y="718.6826">SPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="291.5" y="82.9951">target</text><ellipse cx="315" cy="13" fill="#FEFECE" filter="url(#flmeziw9jxx4t)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M315,21 L315,48 M302,29 L328,29 M315,48 L302,63 M315,48 L328,63 " fill="none" filter="url(#flmeziw9jxx4t)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="291.5" y="711.6826">target</text><ellipse cx="315" cy="724.9844" fill="#FEFECE" filter="url(#flmeziw9jxx4t)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M315,732.9844 L315,759.9844 M302,740.9844 L328,740.9844 M315,759.9844 L302,774.9844 M315,759.9844 L328,774.9844 " fill="none" filter="url(#flmeziw9jxx4t)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="490" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="497.5" y="54.6982">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="497" y="70.9951">(embedded)</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="490" y="698.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="497.5" y="718.6826">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="497" y="734.9795">(embedded)</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="604" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="611" y="70.9951">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="604" y="698.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="611" y="718.6826">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="751" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="758" y="70.9951">CPublic.pem</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="751" y="698.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="758" y="718.6826">CPublic.pem</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="865" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="872" y="70.9951">AESKey/AESIv</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="865" y="698.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="872" y="718.6826">AESKey/AESIv</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1335.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1342.5" y="70.9951">File</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1335.5" y="698.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1342.5" y="718.6826">File</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="1724.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="1731.5" y="70.9951">AESKeySQL.sql</text><rect fill="#FEFECE" filter="url(#flmeziw9jxx4t)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="1724.5" y="698.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="1731.5" y="718.6826">AESKeySQL.sql</text><polygon fill="#FBFB77" filter="url(#flmeziw9jxx4t)" points="131,101.2969,589,101.2969,599,112.2969,589,124.2969,131,124.2969,121,112.2969,131,101.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="246.5" y="117.3638">server rsa key pair (keysize: 13768)</text><polygon fill="#FBFB77" filter="url(#flmeziw9jxx4t)" points="624,134.4297,850,134.4297,860,145.4297,850,157.4297,624,157.4297,614,145.4297,624,134.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="630.5" y="150.4966">client rsa key pair (keysize: 2048)</text><polygon fill="#FBFB77" filter="url(#flmeziw9jxx4t)" points="823,167.5625,1018,167.5625,1028,178.5625,1018,190.5625,823,190.5625,813,178.5625,823,167.5625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="825" y="183.6294">256-Bit-AESKey/128-Bit-AESIv</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="81" y1="231.9609" y2="231.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="81" x2="81" y1="231.9609" y2="244.9609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40" x2="81" y1="244.9609" y2="244.9609"/><polygon fill="#A80036" points="50,240.9609,40,244.9609,50,248.9609,46,244.9609" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="219.3286">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="59" y="211.7622">generate the RSA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="63" y="226.895">server key pair</text><polygon fill="#A80036" points="303,298.0938,313,302.0938,303,306.0938,307,302.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="309" y1="302.0938" y2="302.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="297.0278">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="59" y="297.0278">compromise the target host machine</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="357" y1="346.3594" y2="346.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="357" x2="357" y1="346.3594" y2="359.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="357" y1="359.3594" y2="359.3594"/><polygon fill="#A80036" points="326,355.3594,316,359.3594,326,363.3594,322,359.3594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="333.7271">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="335" y="326.1606">generate an infection specific</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="339" y="341.2935">client RSA key pair</text><polygon fill="#A80036" points="660.5,399.625,670.5,403.625,660.5,407.625,664.5,403.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="666.5" y1="403.625" y2="403.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="390.9927">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="335" y="383.4263">encrypt the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="412" y="383.4263">CPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="545" y="383.4263">with the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="339" y="398.5591">embedded</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="412" y="398.5591">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="508" y="398.5591">in the ransomware</text><polygon fill="#A80036" points="326,433.7578,316,437.7578,326,441.7578,322,437.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="320" x2="671.5" y1="437.7578" y2="437.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="332" y="432.6919">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="345" y="432.6919">save CPrivateRSA.bin on the host machine</text><path d="M166,416.625 L166,441.625 L306,441.625 L306,426.625 L296,416.625 L166,416.625 " fill="#FBFB77" filter="url(#flmeziw9jxx4t)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M296,416.625 L296,426.625 L306,426.625 L296,416.625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="172" y="433.6919">CPrivateRSA.bin</text><path d="M281.5,457.7578 L358.5,457.7578 L358.5,464.7578 L348.5,474.7578 L281.5,474.7578 L281.5,457.7578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="114.5313" style="stroke: #000000; stroke-width: 2.0;" width="1574" x="281.5" y="457.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="296.5" y="470.8247">loop</text><polygon fill="#A80036" points="909,492.0234,919,496.0234,909,500.0234,913,496.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="915" y1="496.0234" y2="496.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="490.9575">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="400" x="335" y="490.9575">generate for each file a new 256-Bit-AESKey and 128-Bit-AESIv</text><polygon fill="#A80036" points="1344,526.1563,1354,530.1563,1344,534.1563,1348,530.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="921" x2="1350" y1="530.1563" y2="530.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="928" y="525.0903">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="398" x="941" y="525.0903">encrypt file with 256-Bit-AESKey and save with butterfly ending</text><path d="M1361,509.0234 L1361,534.0234 L1415,534.0234 L1415,519.0234 L1405,509.0234 L1361,509.0234 " fill="#FBFB77" filter="url(#flmeziw9jxx4t)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1405,509.0234 L1405,519.0234 L1415,519.0234 L1405,509.0234 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="1367" y="526.0903">*.bfly</text><polygon fill="#A80036" points="1773,560.2891,1783,564.2891,1773,568.2891,1777,564.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1356" x2="1779" y1="564.2891" y2="564.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1363" y="559.2231">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="392" x="1376" y="559.2231">save filepath, file hash and AESKey/AESIv pair in sql database</text><polygon fill="#A80036" points="814,596.4219,804,600.4219,814,604.4219,810,600.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="808" x2="1784" y1="600.4219" y2="600.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="820" y="595.356">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="833" y="595.356">encrypt AESKeySQL.sql with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="1015" y="595.356">CPublic.pem</text><polygon fill="#A80036" points="326,630.5547,316,634.5547,326,638.5547,322,634.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="320" x2="802" y1="634.5547" y2="634.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="332" y="629.4888">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="268" x="354" y="629.4888">save AESKeySQL.bin on the host machine</text><path d="M174,613.4219 L174,638.4219 L306,638.4219 L306,623.4219 L296,613.4219 L174,613.4219 " fill="#FBFB77" filter="url(#flmeziw9jxx4t)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M296,613.4219 L296,623.4219 L306,623.4219 L296,613.4219 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="111" x="180" y="630.4888">AESKeySQL.bin</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="357" y1="668.6875" y2="668.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="357" x2="357" y1="668.6875" y2="681.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="357" y1="681.6875" y2="681.6875"/><polygon fill="#A80036" points="326,677.6875,316,681.6875,326,685.6875,322,681.6875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="322" y="663.6216">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="344" y="663.6216">display ransom payment note</text><!--
@startuml

actor attacker
participant SPrivateRSA.pem as SPrivate
actor target
participant "SPublic.pem\n(embedded)" as SPublic
participant CPrivateRSA.pem as CPrivate
participant CPublic.pem as CPublic
participant "AESKey/AESIv" as AESKey
participant File
participant AESKeySQL.sql as AESKeySQL

autonumber
hnote over SPrivate, SPublic: server rsa key pair (keysize: 13768)
hnote over CPrivate, CPublic: client rsa key pair (keysize: 2048)
hnote over AESKey: 256-Bit-AESKey/128-Bit-AESIv
attacker -> attacker: generate the RSA\n server key pair
...
attacker -> target: compromise the target host machine
target -> target: generate an infection specific\n client RSA key pair
target -> CPrivate: encrypt the **CPrivateRSA.pem** with the\n embedded **SPublic.pem** in the ransomware
CPrivate -> target: save CPrivateRSA.bin on the host machine
note left: **CPrivateRSA.bin**
loop
target -> AESKey: generate for each file a new 256-Bit-AESKey and 128-Bit-AESIv
AESKey -> File: encrypt file with 256-Bit-AESKey and save with butterfly ending
note right: ~*.bfly
File -> AESKeySQL: save filepath, file hash and AESKey/AESIv pair in sql database

end
AESKeySQL -> CPublic: encrypt AESKeySQL.sql with **CPublic.pem**
CPublic -> target: save AESKeySQL.bin on the host machine
note left: **AESKeySQL.bin**
target -> target: display ransom payment note

@enduml

PlantUML version 1.2018.13(Mon Nov 26 18:11:51 CET 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.11+9-Ubuntu-0ubuntu2.20.04
Operating System: Linux
OS Version: 5.11.0-27-generic
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>