<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="753px" preserveAspectRatio="none" style="width:1478px;height:753px;" version="1.1" viewBox="0 0 1478 753" width="1478px" zoomAndPan="magnify"><defs><filter height="300%" id="f11gcw8p3ansfm" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f11gcw8p3ansfm)" height="114.5313" style="stroke: #000000; stroke-width: 2.0;" width="1185.5" x="281.5" y="424.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="86.2969" y2="219.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="39" x2="39" y1="219.8281" y2="247.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="39" y1="247.8281" y2="666.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179" x2="179" y1="86.2969" y2="219.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="179" x2="179" y1="219.8281" y2="247.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="179" x2="179" y1="247.8281" y2="666.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="314.5" y1="86.2969" y2="219.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="314.5" x2="314.5" y1="219.8281" y2="247.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="314.5" y1="247.8281" y2="666.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="529" x2="529" y1="86.2969" y2="219.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="529" x2="529" y1="219.8281" y2="247.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="529" x2="529" y1="247.8281" y2="666.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="659" x2="659" y1="86.2969" y2="219.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="659" x2="659" y1="219.8281" y2="247.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="659" x2="659" y1="247.8281" y2="666.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="790" x2="790" y1="86.2969" y2="219.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="790" x2="790" y1="219.8281" y2="247.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="790" x2="790" y1="247.8281" y2="666.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1054" x2="1054" y1="86.2969" y2="219.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1054" x2="1054" y1="219.8281" y2="247.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1054" x2="1054" y1="247.8281" y2="666.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1357.5" x2="1357.5" y1="86.2969" y2="219.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1357.5" x2="1357.5" y1="219.8281" y2="247.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1357.5" x2="1357.5" y1="247.8281" y2="666.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="82.9951">attacker</text><ellipse cx="39" cy="13" fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,21 L39,48 M26,29 L52,29 M39,48 L26,63 M39,48 L52,63 " fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="8" y="678.5498">attacker</text><ellipse cx="39" cy="691.8516" fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M39,699.8516 L39,726.8516 M26,707.8516 L52,707.8516 M39,726.8516 L26,741.8516 M39,726.8516 L52,741.8516 " fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="111" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="118" y="70.9951">SPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="111" y="665.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="118" x="118" y="685.5498">SPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="291.5" y="82.9951">target</text><ellipse cx="315" cy="13" fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M315,21 L315,48 M302,29 L328,29 M315,48 L302,63 M315,48 L328,63 " fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="291.5" y="678.5498">target</text><ellipse cx="315" cy="691.8516" fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M315,699.8516 L315,726.8516 M302,707.8516 L328,707.8516 M315,726.8516 L302,741.8516 M315,726.8516 L328,741.8516 " fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="477" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="484.5" y="54.6982">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="484" y="70.9951">(embedded)</text><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="477" y="665.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="484.5" y="685.5498">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="484" y="701.8467">(embedded)</text><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="591" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="598" y="70.9951">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="591" y="665.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="598" y="685.5498">CPrivateRSA.pem</text><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="738" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="745" y="70.9951">CPublic.pem</text><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="100" x="738" y="665.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="745" y="685.5498">CPublic.pem</text><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="1019" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="1026" y="70.9951">AESKey</text><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="1019" y="665.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="1026" y="685.5498">AESKey</text><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1337.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1344.5" y="70.9951">File</text><rect fill="#FEFECE" filter="url(#f11gcw8p3ansfm)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="37" x="1337.5" y="665.5547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="23" x="1344.5" y="685.5498">File</text><polygon fill="#FBFB77" filter="url(#f11gcw8p3ansfm)" points="131,101.2969,576,101.2969,586,112.2969,576,124.2969,131,124.2969,121,112.2969,131,101.2969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="240" y="117.3638">server rsa key pair (keysize: 13768)</text><polygon fill="#FBFB77" filter="url(#f11gcw8p3ansfm)" points="611,134.4297,837,134.4297,847,145.4297,837,157.4297,611,157.4297,601,145.4297,611,134.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="213" x="617.5" y="150.4966">client rsa key pair (keysize: 2048)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="81" y1="198.8281" y2="198.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="81" x2="81" y1="198.8281" y2="211.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40" x2="81" y1="211.8281" y2="211.8281"/><polygon fill="#A80036" points="50,207.8281,40,211.8281,50,215.8281,46,211.8281" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="186.1958">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="59" y="178.6294">generate the RSA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="63" y="193.7622">server key pair</text><polygon fill="#A80036" points="303,264.8281,313,268.8281,303,272.8281,307,268.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="39" x2="309" y1="268.8281" y2="268.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="46" y="263.895">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="59" y="263.895">compromise the target host machine</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="357" y1="313.2266" y2="313.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="357" x2="357" y1="313.2266" y2="326.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="357" y1="326.2266" y2="326.2266"/><polygon fill="#A80036" points="326,322.2266,316,326.2266,326,330.2266,322,326.2266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="300.5942">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="335" y="293.0278">generate an infection specific</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="339" y="308.1606">client RSA key pair</text><polygon fill="#A80036" points="647.5,366.2266,657.5,370.2266,647.5,374.2266,651.5,370.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="653.5" y1="370.2266" y2="370.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="357.8599">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="335" y="350.2935">encrypt the</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="129" x="412" y="350.2935">CPrivateRSA.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="545" y="350.2935">with the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="339" y="365.4263">embedded</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="412" y="365.4263">SPublic.pem</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="508" y="365.4263">in the ransomware</text><polygon fill="#A80036" points="326,400.4922,316,404.4922,326,408.4922,322,404.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="320" x2="658.5" y1="404.4922" y2="404.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="332" y="399.5591">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="345" y="399.5591">save CPrivateRSA.bin on the host machine</text><polygon fill="#FBFB77" filter="url(#f11gcw8p3ansfm)" points="166,383.4922,166,408.4922,306,408.4922,306,393.4922,296,383.4922,166,383.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="296" x2="296" y1="383.4922" y2="393.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="306" x2="296" y1="393.4922" y2="393.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="119" x="172" y="400.5591">CPrivateRSA.bin</text><rect fill="none" height="114.5313" style="stroke: #000000; stroke-width: 2.0;" width="1185.5" x="281.5" y="424.625"/><polygon fill="#EEEEEE" points="281.5,424.625,358.5,424.625,358.5,431.625,348.5,441.625,281.5,441.625,281.5,424.625" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="296.5" y="437.6919">loop</text><polygon fill="#A80036" points="1042,458.7578,1052,462.7578,1042,466.7578,1046,462.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="1048" y1="462.7578" y2="462.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="322" y="457.8247">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="279" x="335" y="457.8247">generate for each file a new 128 Bit AESKey</text><polygon fill="#A80036" points="1346,487.8906,1356,491.8906,1346,495.8906,1350,491.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1054" x2="1352" y1="491.8906" y2="491.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1061" y="486.9575">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="1074" y="486.9575">encrypt file with 128 Bit AESKey</text><polygon fill="#A80036" points="1065,522.0234,1055,526.0234,1065,530.0234,1061,526.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1059" x2="1357" y1="526.0234" y2="526.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="1071" y="521.0903">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="267" x="1084" y="521.0903">save encrypted files with butterfly endings</text><polygon fill="#FBFB77" filter="url(#f11gcw8p3ansfm)" points="1363,505.0234,1363,530.0234,1448,530.0234,1448,515.0234,1438,505.0234,1363,505.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1438" x2="1438" y1="505.0234" y2="515.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1448" x2="1438" y1="515.0234" y2="515.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="1369" y="522.0903">*.butterfly</text><polygon fill="#A80036" points="801,563.1563,791,567.1563,801,571.1563,797,567.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="795" x2="1053" y1="567.1563" y2="567.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="807" y="562.2231">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="820" y="562.2231">encrypt AESKey with</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="954" y="562.2231">CPublic.pem</text><polygon fill="#A80036" points="326,597.2891,316,601.2891,326,605.2891,322,601.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="320" x2="789" y1="601.2891" y2="601.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="332" y="596.356">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="354" y="596.356">save AESKey.bin</text><polygon fill="#FBFB77" filter="url(#f11gcw8p3ansfm)" points="202,580.2891,202,605.2891,306,605.2891,306,590.2891,296,580.2891,202,580.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="296" x2="296" y1="580.2891" y2="590.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="306" x2="296" y1="590.2891" y2="590.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="83" x="208" y="597.356">AESKey.bin</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="315" x2="357" y1="635.5547" y2="635.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="357" x2="357" y1="635.5547" y2="648.5547"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="316" x2="357" y1="648.5547" y2="648.5547"/><polygon fill="#A80036" points="326,644.5547,316,648.5547,326,652.5547,322,648.5547" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="322" y="630.4888">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="344" y="630.4888">display ransom note</text><!--
@startuml
'https://plantuml.com/sequence-diagram

actor attacker
participant SPrivateRSA.pem as SPrivate
actor target
participant "SPublic.pem\n(embedded)" as SPublic
participant CPrivateRSA.pem as CPrivate
participant CPublic.pem as CPublic
participant AESKey
participant File

autonumber
hnote over SPrivate, SPublic: server rsa key pair (keysize: 13768)
hnote over CPrivate, CPublic: client rsa key pair (keysize: 2048)

attacker -> attacker: generate the RSA\n server key pair
...
attacker -> target: compromise the target host machine
target -> target: generate an infection specific\n client RSA key pair
target -> CPrivate: encrypt the **CPrivateRSA.pem** with the\n embedded **SPublic.pem** in the ransomware
CPrivate -> target: save CPrivateRSA.bin on the host machine
note left: **CPrivateRSA.bin**
loop
target -> AESKey: generate for each file a new 128 Bit AESKey
AESKey -> File: encrypt file with 128 Bit AESKey
File -> AESKey: save encrypted files with butterfly endings
note right: ~*.butterfly
end
AESKey -> CPublic: encrypt AESKey with **CPublic.pem**
CPublic -> target: save AESKey.bin
note left: **AESKey.bin**
target -> target: display ransom note

@enduml

PlantUML version 1.2017.15(Mon Jul 03 18:45:34 CEST 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.10+9-Ubuntu-0ubuntu1.18.04
Operating System: Linux
OS Version: 5.4.0-67-generic
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>