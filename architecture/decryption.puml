@startuml
'https://plantuml.com/sequence-diagram
actor attacker
participant SPrivateRSA.pem as SPrivate
actor target
participant "SPublic.pem\n(embedded)" as SPublic
participant CPrivateRSA.pem as CPrivate
participant CPublic.pem as CPublic
participant AESKey
participant File
autonumber

attacker <- target: pay ransom
attacker -> target: sends the SPrivateRSA.pem file

target -> CPrivate: decrypt the CPrivateRSA.bin\n with SPrivateRSA.pem
CPrivate -> target: get CPrivateRSA.pem
target -> AESKey: decrypt the AESKey.bin with CPrivateRSA.pem
loop
AESKey -> File: decrypt file with AESKey
File -> AESKey: file.txt
end
File -> target: Access to all decrypted files
@enduml