<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="719px" preserveAspectRatio="none" style="width:1246px;height:719px;" version="1.1" viewBox="0 0 1246 719" width="1246px" zoomAndPan="magnify"><defs><filter height="300%" id="f1f1zrnv9iyrgn" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster butterfly--><polygon fill="#AAAAAA" filter="url(#f1f1zrnv9iyrgn)" points="22,24,96,24,103,46.2969,1224,46.2969,1224,707,22,707,22,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="103" y1="46.2969" y2="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="26" y="38.9951">butterfly</text><!--cluster rsa--><polygon fill="#DDDDDD" filter="url(#f1f1zrnv9iyrgn)" points="46,67,77,67,84,89.2969,1200,89.2969,1200,683,46,683,46,67" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="46" x2="84" y1="89.2969" y2="89.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="50" y="81.9951">rsa</text><!--class CryptoRSA--><rect fill="#FEFECE" filter="url(#f1f1zrnv9iyrgn)" height="355.3125" id="CryptoRSA" style="stroke: #A80036; stroke-width: 1.5;" width="667" x="289.5" y="102"/><ellipse cx="586.75" cy="118" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M589.7188,123.6406 Q589.1406,123.9375 588.5,124.0781 Q587.8594,124.2344 587.1563,124.2344 Q584.6563,124.2344 583.3281,122.5938 Q582.0156,120.9375 582.0156,117.8125 Q582.0156,114.6875 583.3281,113.0313 Q584.6563,111.375 587.1563,111.375 Q587.8594,111.375 588.5,111.5313 Q589.1563,111.6875 589.7188,111.9844 L589.7188,114.7031 Q589.0938,114.125 588.5,113.8594 Q587.9063,113.5781 587.2813,113.5781 Q585.9375,113.5781 585.25,114.6563 Q584.5625,115.7188 584.5625,117.8125 Q584.5625,119.9063 585.25,120.9844 Q585.9375,122.0469 587.2813,122.0469 Q587.9063,122.0469 588.5,121.7813 Q589.0938,121.5 589.7188,120.9219 L589.7188,123.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="607.25" y="122.1543">CryptoRSA</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="290.5" x2="955.5" y1="134" y2="134"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="297.5" y="142.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="309.5" y="148.2104">_rsa: RSA*</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="297.5" y="155.707"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="309.5" y="161.0151">_pkey: EVP_PKEY*</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="297.5" y="168.5117"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="309.5" y="173.8198">_keySize, _paddingSize: int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="297.5" y="181.3164"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="339" x="309.5" y="186.6245">_rsaPrivateKeyStr, *_rsaPublicKeyStr, *_publicKeyStr: char*</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="290.5" x2="955.5" y1="193.2188" y2="193.2188"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="297.5" y="202.1211"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="309.5" y="207.4292">initPaddingSize(): void</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="297.5" y="214.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="281" x="309.5" y="220.2339">loadKeyFromFile(const std::string &amp;filepath): void</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="297.5" y="227.7305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="253" x="309.5" y="233.0386">loadKeyFromStr(const std::string &amp;str): void</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="297.5" y="240.5352"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="309.5" y="245.8433">getOpenSSLError(): string</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="297.5" y="253.3398"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="309.5" y="258.6479">generateRSAKey(): bool</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="297.5" y="266.1445"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="441" x="309.5" y="271.4526">validateStringLengthForRSA(const std::string &amp;msg, const int &amp;keysize): bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="313.5" y="284.2573"/><ellipse cx="300.5" cy="294.7539" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="309.5" y="297.062">CryptoRSA()</text><ellipse cx="300.5" cy="307.5586" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="127" x="309.5" y="309.8667">CryptoRSA(int keySize)</text><ellipse cx="300.5" cy="320.3633" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="309.5" y="322.6714">CryptoRSA(const std::string &amp;key)</text><ellipse cx="300.5" cy="333.168" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="104" x="309.5" y="335.4761">getRSAKey(): RSA*</text><ellipse cx="300.5" cy="345.9727" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="309.5" y="348.2808">getRSAKeySize(): int</text><ellipse cx="300.5" cy="358.7773" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="309.5" y="361.0854">getPaddingSize(): int</text><ellipse cx="300.5" cy="371.582" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="309.5" y="373.8901">getEvpPkey(): EVP_PKEY*</text><ellipse cx="300.5" cy="384.3867" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="309.5" y="386.6948">getEvpPkeySize(EVP_PKEY *key): int</text><ellipse cx="300.5" cy="397.1914" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="163" x="309.5" y="399.4995">getRSAPrivateKeyStr(): char*</text><ellipse cx="300.5" cy="409.9961" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="378" x="309.5" y="412.3042">getPkeyFromPrivateKeyFile(const std::string &amp;filepath): EVP_PKEY*</text><ellipse cx="300.5" cy="422.8008" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="372" x="309.5" y="425.1089">getPkeyFromPublicKeyFile(const std::string &amp;filepath): EVP_PKEY*</text><ellipse cx="300.5" cy="435.6055" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="641" x="309.5" y="437.9136">encrypt(EVP_PKEY *key, const unsigned char *plaintext, size_t plaintextLength, unsigned char *ciphertext): size_t</text><ellipse cx="300.5" cy="448.4102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="614" x="309.5" y="450.7183">decrypt(EVP_PKEY *key, unsigned char* ciphertext, size_t ciphertextLength, unsigned char* plaintext): size_t</text><!--class RSAEncryptor--><rect fill="#FEFECE" filter="url(#f1f1zrnv9iyrgn)" height="150.4375" id="RSAEncryptor" style="stroke: #A80036; stroke-width: 1.5;" width="619" x="62.5" y="517"/><ellipse cx="325.75" cy="533" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M328.7188,538.6406 Q328.1406,538.9375 327.5,539.0781 Q326.8594,539.2344 326.1563,539.2344 Q323.6563,539.2344 322.3281,537.5938 Q321.0156,535.9375 321.0156,532.8125 Q321.0156,529.6875 322.3281,528.0313 Q323.6563,526.375 326.1563,526.375 Q326.8594,526.375 327.5,526.5313 Q328.1563,526.6875 328.7188,526.9844 L328.7188,529.7031 Q328.0938,529.125 327.5,528.8594 Q326.9063,528.5781 326.2813,528.5781 Q324.9375,528.5781 324.25,529.6563 Q323.5625,530.7188 323.5625,532.8125 Q323.5625,534.9063 324.25,535.9844 Q324.9375,537.0469 326.2813,537.0469 Q326.9063,537.0469 327.5,536.7813 Q328.0938,536.5 328.7188,535.9219 L328.7188,538.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="346.25" y="537.1543">RSAEncryptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="63.5" x2="680.5" y1="549" y2="549"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="557.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="149" x="82.5" y="563.2104">_encryptedKey: std::string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="63.5" x2="680.5" y1="569.8047" y2="569.8047"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="70.5" y="578.707"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="441" x="82.5" y="584.0151">validateStringLengthForRSA(const std::string &amp;msg, const int &amp;keysize): bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="86.5" y="596.8198"/><ellipse cx="73.5" cy="607.3164" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="82.5" y="609.6245">RSAEncryptor(int keySize)</text><ellipse cx="73.5" cy="620.1211" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="82.5" y="622.4292">RSAEncryptor(const std::string &amp;key)</text><ellipse cx="73.5" cy="632.9258" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="169" x="82.5" y="635.2339">getEncryptedKey(): std::string</text><ellipse cx="73.5" cy="645.7305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="593" x="82.5" y="648.0386">saveEncryptedKeyFile(const std::string &amp;filename, const std::string &amp;ciphertextKey, int keyLength): void</text><ellipse cx="73.5" cy="658.5352" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="314" x="82.5" y="660.8433">encrypt(EVP_PKEY *pkey, const std::string &amp;msg): bool</text><!--class RSADecryptor--><rect fill="#FEFECE" filter="url(#f1f1zrnv9iyrgn)" height="150.4375" id="RSADecryptor" style="stroke: #A80036; stroke-width: 1.5;" width="467" x="716.5" y="517"/><ellipse cx="903.25" cy="533" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M906.2188,538.6406 Q905.6406,538.9375 905,539.0781 Q904.3594,539.2344 903.6563,539.2344 Q901.1563,539.2344 899.8281,537.5938 Q898.5156,535.9375 898.5156,532.8125 Q898.5156,529.6875 899.8281,528.0313 Q901.1563,526.375 903.6563,526.375 Q904.3594,526.375 905,526.5313 Q905.6563,526.6875 906.2188,526.9844 L906.2188,529.7031 Q905.5938,529.125 905,528.8594 Q904.4063,528.5781 903.7813,528.5781 Q902.4375,528.5781 901.75,529.6563 Q901.0625,530.7188 901.0625,532.8125 Q901.0625,534.9063 901.75,535.9844 Q902.4375,537.0469 903.7813,537.0469 Q904.4063,537.0469 905,536.7813 Q905.5938,536.5 906.2188,535.9219 L906.2188,538.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="923.75" y="537.1543">RSADecryptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="717.5" x2="1182.5" y1="549" y2="549"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="724.5" y="557.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="149" x="736.5" y="563.2104">_decryptedKey: std::string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="717.5" x2="1182.5" y1="569.8047" y2="569.8047"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="724.5" y="578.707"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="441" x="736.5" y="584.0151">validateStringLengthForRSA(const std::string &amp;msg, const int &amp;keysize): bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="740.5" y="596.8198"/><ellipse cx="727.5" cy="607.3164" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="736.5" y="609.6245">RSADecryptor()</text><ellipse cx="727.5" cy="620.1211" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="736.5" y="622.4292">RSADecryptor(const std::string &amp;key)</text><ellipse cx="727.5" cy="632.9258" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="170" x="736.5" y="635.2339">getDecryptedKey(): std::string</text><ellipse cx="727.5" cy="645.7305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="351" x="736.5" y="648.0386">getBinKeyFileContents(const std::string &amp;filepath): std::string</text><ellipse cx="727.5" cy="658.5352" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="314" x="736.5" y="660.8433">decrypt(EVP_PKEY *pkey, const std::string &amp;msg): bool</text><!--link CryptoRSA to RSAEncryptor--><path d="M477.09,461 C461.21,480.65 445.77,499.74 431.85,516.97 " fill="none" id="CryptoRSA-RSAEncryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="480.27,457.07,471.5082,461.5678,477.1326,460.9632,477.7373,466.5876,480.27,457.07" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CryptoRSA to RSADecryptor--><path d="M812.58,460.51 C833.45,480.33 853.74,499.59 872.03,516.97 " fill="none" id="CryptoRSA-RSADecryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="808.95,457.07,812.7256,466.1664,812.5771,460.5115,818.232,460.363,808.95,457.07" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
package butterfly #AAAAAA
{

package rsa #DDDDDD
{

class CryptoRSA
{
    -_rsa: RSA*
    -_pkey: EVP_PKEY*
    -_keySize, _paddingSize: int
    -_rsaPrivateKeyStr, *_rsaPublicKeyStr, *_publicKeyStr: char*

    -initPaddingSize(): void
    -loadKeyFromFile(const std::string &filepath): void
    -loadKeyFromStr(const std::string &str): void
    -getOpenSSLError(): string
    -generateRSAKey(): bool
    -validateStringLengthForRSA(const std::string &msg, const int &keysize): bool

    +CryptoRSA()
    +CryptoRSA(int keySize)
    +CryptoRSA(const std::string &key)
    +getRSAKey(): RSA*
    +getRSAKeySize(): int
    +getPaddingSize(): int
    +getEvpPkey(): EVP_PKEY*
    +getEvpPkeySize(EVP_PKEY *key): int
    +getRSAPrivateKeyStr(): char*
    +getPkeyFromPrivateKeyFile(const std::string &filepath): EVP_PKEY*
    +getPkeyFromPublicKeyFile(const std::string &filepath): EVP_PKEY*
    +encrypt(EVP_PKEY *key, const unsigned char *plaintext, size_t plaintextLength, unsigned char *ciphertext): size_t
    +decrypt(EVP_PKEY *key, unsigned char* ciphertext, size_t ciphertextLength, unsigned char* plaintext): size_t
}

class RSAEncryptor
{
    -_encryptedKey: std::string

    -validateStringLengthForRSA(const std::string &msg, const int &keysize): bool

    +RSAEncryptor(int keySize)
    +RSAEncryptor(const std::string &key)
    +getEncryptedKey(): std::string
    +saveEncryptedKeyFile(const std::string &filename, const std::string &ciphertextKey, int keyLength): void
    +encrypt(EVP_PKEY *pkey, const std::string &msg): bool
}

class RSADecryptor
{
    -_decryptedKey: std::string
    -validateStringLengthForRSA(const std::string &msg, const int &keysize): bool

    +RSADecryptor()
    +RSADecryptor(const std::string &key)
    +getDecryptedKey(): std::string
    +getBinKeyFileContents(const std::string &filepath): std::string
    +decrypt(EVP_PKEY *pkey, const std::string &msg): bool
}

CryptoRSA <- - RSAEncryptor
CryptoRSA <- - RSADecryptor

}

}
@enduml

PlantUML version 1.2018.13(Mon Nov 26 18:11:51 CET 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.11+9-Ubuntu-0ubuntu2.20.04
Operating System: Linux
OS Version: 5.11.0-27-generic
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>