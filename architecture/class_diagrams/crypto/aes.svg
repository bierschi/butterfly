<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="604px" preserveAspectRatio="none" style="width:749px;height:604px;" version="1.1" viewBox="0 0 749 604" width="749px" zoomAndPan="magnify"><defs><filter height="300%" id="fw0i0t2ucrhu9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster butterfly--><polygon fill="#AAAAAA" filter="url(#fw0i0t2ucrhu9)" points="22,24,96,24,103,46.2969,727,46.2969,727,592,22,592,22,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="103" y1="46.2969" y2="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="26" y="38.9951">butterfly</text><!--cluster aes--><polygon fill="#DDDDDD" filter="url(#fw0i0t2ucrhu9)" points="46,67,80,67,87,89.2969,703,89.2969,703,568,46,568,46,67" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="46" x2="87" y1="89.2969" y2="89.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="50" y="81.9951">aes</text><!--class CryptoAES--><rect fill="#FEFECE" filter="url(#fw0i0t2ucrhu9)" height="304.0938" id="CryptoAES" style="stroke: #A80036; stroke-width: 1.5;" width="581" x="83.5" y="102"/><ellipse cx="337.75" cy="118" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M340.7188,123.6406 Q340.1406,123.9375 339.5,124.0781 Q338.8594,124.2344 338.1563,124.2344 Q335.6563,124.2344 334.3281,122.5938 Q333.0156,120.9375 333.0156,117.8125 Q333.0156,114.6875 334.3281,113.0313 Q335.6563,111.375 338.1563,111.375 Q338.8594,111.375 339.5,111.5313 Q340.1563,111.6875 340.7188,111.9844 L340.7188,114.7031 Q340.0938,114.125 339.5,113.8594 Q338.9063,113.5781 338.2813,113.5781 Q336.9375,113.5781 336.25,114.6563 Q335.5625,115.7188 335.5625,117.8125 Q335.5625,119.9063 336.25,120.9844 Q336.9375,122.0469 338.2813,122.0469 Q338.9063,122.0469 339.5,121.7813 Q340.0938,121.5 340.7188,120.9219 L340.7188,123.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="358.25" y="122.1543">CryptoAES</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="84.5" x2="663.5" y1="134" y2="134"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="91.5" y="142.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="342" x="103.5" y="148.2104">_aesEncryptContext, _aesDecryptContext: EVP_CIPHER_CTX*</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="91.5" y="155.707"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="103.5" y="161.0151">_aesKeyLength, _aesIvLength: int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="107.5" y="173.8198"/><polygon fill="none" points="94.5,179.3164,98.5,183.3164,94.5,187.3164,90.5,183.3164" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="174" x="103.5" y="186.6245">aesKey, aesIv: unsigned char*</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="84.5" x2="663.5" y1="193.2188" y2="193.2188"/><ellipse cx="94.5" cy="205.1211" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="103.5" y="207.4292">CryptoAES()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="107.5" y="220.2339"/><ellipse cx="94.5" cy="230.7305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="86" x="103.5" y="233.0386">initDone(): bool</text><ellipse cx="94.5" cy="243.5352" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="103.5" y="245.8433">generateAESKey(): bool</text><ellipse cx="94.5" cy="256.3398" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="178" x="103.5" y="258.6479">generateAESKeyWithSalt(): bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="107.5" y="271.4526"/><ellipse cx="94.5" cy="281.9492" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="213" x="103.5" y="284.2573">setAESKey(std::string &amp;aesKey): void</text><ellipse cx="94.5" cy="294.7539" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="103.5" y="297.062">setAESIv(std::string &amp;aesIv): void</text><ellipse cx="94.5" cy="307.5586" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="170" x="103.5" y="309.8667">getAESKey() const: std::string</text><ellipse cx="94.5" cy="320.3633" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="159" x="103.5" y="322.6714">getAESIv() const: std::string</text><ellipse cx="94.5" cy="333.168" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="192" x="103.5" y="335.4761">getAESKeyPair() const: std::string</text><ellipse cx="94.5" cy="345.9727" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="163" x="103.5" y="348.2808">getAESKeyLength() const: int</text><ellipse cx="94.5" cy="358.7773" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="103.5" y="361.0854">getAESIVLength() const: int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="107.5" y="373.8901"/><ellipse cx="94.5" cy="384.3867" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="555" x="103.5" y="386.6948">encrypt(const unsigned char *plaintext, size_t plaintextLength, unsigned char **ciphertext): size_t</text><ellipse cx="94.5" cy="397.1914" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="528" x="103.5" y="399.4995">decrypt(unsigned char *ciphertext, size_t ciphertextLength, unsigned char **plaintext): size_t</text><!--class AESEncryptor--><rect fill="#FEFECE" filter="url(#fw0i0t2ucrhu9)" height="86.4141" id="AESEncryptor" style="stroke: #A80036; stroke-width: 1.5;" width="283" x="62.5" y="466"/><ellipse cx="157.75" cy="482" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M160.7188,487.6406 Q160.1406,487.9375 159.5,488.0781 Q158.8594,488.2344 158.1563,488.2344 Q155.6563,488.2344 154.3281,486.5938 Q153.0156,484.9375 153.0156,481.8125 Q153.0156,478.6875 154.3281,477.0313 Q155.6563,475.375 158.1563,475.375 Q158.8594,475.375 159.5,475.5313 Q160.1563,475.6875 160.7188,475.9844 L160.7188,478.7031 Q160.0938,478.125 159.5,477.8594 Q158.9063,477.5781 158.2813,477.5781 Q156.9375,477.5781 156.25,478.6563 Q155.5625,479.7188 155.5625,481.8125 Q155.5625,483.9063 156.25,484.9844 Q156.9375,486.0469 158.2813,486.0469 Q158.9063,486.0469 159.5,485.7813 Q160.0938,485.5 160.7188,484.9219 L160.7188,487.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="178.25" y="486.1543">AESEncryptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="63.5" x2="344.5" y1="498" y2="498"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="63.5" x2="344.5" y1="506" y2="506"/><ellipse cx="73.5" cy="517.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="82.5" y="520.2104">AESEncryptor()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="86.5" y="533.0151"/><ellipse cx="73.5" cy="543.5117" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="257" x="82.5" y="545.8198">encryptFile(const std::string &amp;filename): void</text><!--class AESDecryptor--><rect fill="#FEFECE" filter="url(#fw0i0t2ucrhu9)" height="86.4141" id="AESDecryptor" style="stroke: #A80036; stroke-width: 1.5;" width="306" x="381" y="466"/><ellipse cx="487.25" cy="482" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M490.2188,487.6406 Q489.6406,487.9375 489,488.0781 Q488.3594,488.2344 487.6563,488.2344 Q485.1563,488.2344 483.8281,486.5938 Q482.5156,484.9375 482.5156,481.8125 Q482.5156,478.6875 483.8281,477.0313 Q485.1563,475.375 487.6563,475.375 Q488.3594,475.375 489,475.5313 Q489.6563,475.6875 490.2188,475.9844 L490.2188,478.7031 Q489.5938,478.125 489,477.8594 Q488.4063,477.5781 487.7813,477.5781 Q486.4375,477.5781 485.75,478.6563 Q485.0625,479.7188 485.0625,481.8125 Q485.0625,483.9063 485.75,484.9844 Q486.4375,486.0469 487.7813,486.0469 Q488.4063,486.0469 489,485.7813 Q489.5938,485.5 490.2188,484.9219 L490.2188,487.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="507.75" y="486.1543">AESDecryptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="382" x2="686" y1="498" y2="498"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="382" x2="686" y1="506" y2="506"/><ellipse cx="392" cy="517.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="401" y="520.2104">AESDecryptor()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="405" y="533.0151"/><ellipse cx="392" cy="543.5117" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="280" x="401" y="545.8198">decryptFile(const std::string &amp;bflyFileName): void</text><!--link CryptoAES to AESEncryptor--><path d="M260.95,423.25 C250.58,438.68 240.84,453.17 232.45,465.67 " fill="none" id="CryptoAES-AESEncryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="255.45,418.89,272.41,406.19,267.07,426.69,255.45,418.89" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CryptoAES to AESDecryptor--><path d="M480.4,423.25 C490.16,438.68 499.33,453.17 507.23,465.67 " fill="none" id="CryptoAES-AESDecryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="474.39,426.83,469.61,406.19,486.22,419.35,474.39,426.83" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml

package butterfly #AAAAAA
{

package aes #DDDDDD
{

class CryptoAES
{
    - _aesEncryptContext, _aesDecryptContext: EVP_CIPHER_CTX*
    - _aesKeyLength, _aesIvLength: int

    # aesKey, aesIv: unsigned char*

    + CryptoAES()

    + initDone(): bool
    + generateAESKey(): bool
    + generateAESKeyWithSalt(): bool

    + setAESKey(std::string &aesKey): void
    + setAESIv(std::string &aesIv): void
    + getAESKey() const: std::string
    + getAESIv() const: std::string
    + getAESKeyPair() const: std::string
    + getAESKeyLength() const: int
    + getAESIVLength() const: int

    + encrypt(const unsigned char *plaintext, size_t plaintextLength, unsigned char **ciphertext): size_t
    + decrypt(unsigned char *ciphertext, size_t ciphertextLength, unsigned char **plaintext): size_t
}

class AESEncryptor
{
    + AESEncryptor()

    + encryptFile(const std::string &filename): void

}

class AESDecryptor
{
    + AESDecryptor()

    + decryptFile(const std::string &bflyFileName): void
}

CryptoAES <|- - AESEncryptor
CryptoAES <|- - AESDecryptor

}

}
@enduml

PlantUML version 1.2018.13(Mon Nov 26 18:11:51 CET 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.11+9-Ubuntu-0ubuntu2.20.04
Operating System: Linux
OS Version: 5.11.0-38-generic
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>