<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1189px" preserveAspectRatio="none" style="width:2272px;height:1189px;" version="1.1" viewBox="0 0 2272 1189" width="2272px" zoomAndPan="magnify"><defs><filter height="300%" id="f1s24aysut7nxx" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster butterfly--><polygon fill="#AAAAAA" filter="url(#f1s24aysut7nxx)" points="22,24,96,24,103,46.2969,2250,46.2969,2250,1177,22,1177,22,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="103" y1="46.2969" y2="46.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="68" x="26" y="38.9951">butterfly</text><!--cluster aes--><polygon fill="#DDDDDD" filter="url(#f1s24aysut7nxx)" points="1569,124.5,1603,124.5,1610,146.7969,2226,146.7969,2226,742,1569,742,1569,124.5" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1569" x2="1610" y1="146.7969" y2="146.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="1573" y="139.4951">aes</text><!--cluster rsa--><polygon fill="#DDDDDD" filter="url(#f1s24aysut7nxx)" points="154,67,185,67,192,89.2969,1545,89.2969,1545,800,154,800,154,67" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="154" x2="192" y1="89.2969" y2="89.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="158" y="81.9951">rsa</text><!--cluster hybrid--><polygon fill="#DDDDDD" filter="url(#f1s24aysut7nxx)" points="620,849,676,849,683,871.2969,1882,871.2969,1882,1153,620,1153,620,849" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="620" x2="683" y1="871.2969" y2="871.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="624" y="863.9951">hybrid</text><!--class CryptoAES--><rect fill="#FEFECE" filter="url(#f1s24aysut7nxx)" height="304.0938" id="CryptoAES" style="stroke: #A80036; stroke-width: 1.5;" width="581" x="1606.5" y="159.5"/><ellipse cx="1860.75" cy="175.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1863.7188,181.1406 Q1863.1406,181.4375 1862.5,181.5781 Q1861.8594,181.7344 1861.1563,181.7344 Q1858.6563,181.7344 1857.3281,180.0938 Q1856.0156,178.4375 1856.0156,175.3125 Q1856.0156,172.1875 1857.3281,170.5313 Q1858.6563,168.875 1861.1563,168.875 Q1861.8594,168.875 1862.5,169.0313 Q1863.1563,169.1875 1863.7188,169.4844 L1863.7188,172.2031 Q1863.0938,171.625 1862.5,171.3594 Q1861.9063,171.0781 1861.2813,171.0781 Q1859.9375,171.0781 1859.25,172.1563 Q1858.5625,173.2188 1858.5625,175.3125 Q1858.5625,177.4063 1859.25,178.4844 Q1859.9375,179.5469 1861.2813,179.5469 Q1861.9063,179.5469 1862.5,179.2813 Q1863.0938,179 1863.7188,178.4219 L1863.7188,181.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="1881.25" y="179.6543">CryptoAES</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1607.5" x2="2186.5" y1="191.5" y2="191.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1614.5" y="200.4023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="342" x="1626.5" y="205.7104">_aesEncryptContext, _aesDecryptContext: EVP_CIPHER_CTX*</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1614.5" y="213.207"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="189" x="1626.5" y="218.5151">_aesKeyLength, _aesIvLength: int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1630.5" y="231.3198"/><polygon fill="none" points="1617.5,236.8164,1621.5,240.8164,1617.5,244.8164,1613.5,240.8164" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="174" x="1626.5" y="244.1245">aesKey, aesIv: unsigned char*</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1607.5" x2="2186.5" y1="250.7188" y2="250.7188"/><ellipse cx="1617.5" cy="262.6211" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="1626.5" y="264.9292">CryptoAES()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1630.5" y="277.7339"/><ellipse cx="1617.5" cy="288.2305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="86" x="1626.5" y="290.5386">initDone(): bool</text><ellipse cx="1617.5" cy="301.0352" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="1626.5" y="303.3433">generateAESKey(): bool</text><ellipse cx="1617.5" cy="313.8398" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="178" x="1626.5" y="316.1479">generateAESKeyWithSalt(): bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1630.5" y="328.9526"/><ellipse cx="1617.5" cy="339.4492" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="213" x="1626.5" y="341.7573">setAESKey(std::string &amp;aesKey): void</text><ellipse cx="1617.5" cy="352.2539" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="191" x="1626.5" y="354.562">setAESIv(std::string &amp;aesIv): void</text><ellipse cx="1617.5" cy="365.0586" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="170" x="1626.5" y="367.3667">getAESKey() const: std::string</text><ellipse cx="1617.5" cy="377.8633" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="159" x="1626.5" y="380.1714">getAESIv() const: std::string</text><ellipse cx="1617.5" cy="390.668" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="192" x="1626.5" y="392.9761">getAESKeyPair() const: std::string</text><ellipse cx="1617.5" cy="403.4727" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="163" x="1626.5" y="405.7808">getAESKeyLength() const: int</text><ellipse cx="1617.5" cy="416.2773" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="1626.5" y="418.5854">getAESIVLength() const: int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1630.5" y="431.3901"/><ellipse cx="1617.5" cy="441.8867" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="555" x="1626.5" y="444.1948">encrypt(const unsigned char *plaintext, size_t plaintextLength, unsigned char **ciphertext): size_t</text><ellipse cx="1617.5" cy="454.6914" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="528" x="1626.5" y="456.9995">decrypt(unsigned char *ciphertext, size_t ciphertextLength, unsigned char **plaintext): size_t</text><!--class AESEncryptor--><rect fill="#FEFECE" filter="url(#f1s24aysut7nxx)" height="86.4141" id="AESEncryptor" style="stroke: #A80036; stroke-width: 1.5;" width="283" x="1585.5" y="640"/><ellipse cx="1680.75" cy="656" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1683.7188,661.6406 Q1683.1406,661.9375 1682.5,662.0781 Q1681.8594,662.2344 1681.1563,662.2344 Q1678.6563,662.2344 1677.3281,660.5938 Q1676.0156,658.9375 1676.0156,655.8125 Q1676.0156,652.6875 1677.3281,651.0313 Q1678.6563,649.375 1681.1563,649.375 Q1681.8594,649.375 1682.5,649.5313 Q1683.1563,649.6875 1683.7188,649.9844 L1683.7188,652.7031 Q1683.0938,652.125 1682.5,651.8594 Q1681.9063,651.5781 1681.2813,651.5781 Q1679.9375,651.5781 1679.25,652.6563 Q1678.5625,653.7188 1678.5625,655.8125 Q1678.5625,657.9063 1679.25,658.9844 Q1679.9375,660.0469 1681.2813,660.0469 Q1681.9063,660.0469 1682.5,659.7813 Q1683.0938,659.5 1683.7188,658.9219 L1683.7188,661.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="1701.25" y="660.1543">AESEncryptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1586.5" x2="1867.5" y1="672" y2="672"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1586.5" x2="1867.5" y1="680" y2="680"/><ellipse cx="1596.5" cy="691.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="1605.5" y="694.2104">AESEncryptor()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1609.5" y="707.0151"/><ellipse cx="1596.5" cy="717.5117" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="257" x="1605.5" y="719.8198">encryptFile(const std::string &amp;filename): void</text><!--class AESDecryptor--><rect fill="#FEFECE" filter="url(#f1s24aysut7nxx)" height="86.4141" id="AESDecryptor" style="stroke: #A80036; stroke-width: 1.5;" width="306" x="1904" y="640"/><ellipse cx="2010.25" cy="656" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M2013.2188,661.6406 Q2012.6406,661.9375 2012,662.0781 Q2011.3594,662.2344 2010.6563,662.2344 Q2008.1563,662.2344 2006.8281,660.5938 Q2005.5156,658.9375 2005.5156,655.8125 Q2005.5156,652.6875 2006.8281,651.0313 Q2008.1563,649.375 2010.6563,649.375 Q2011.3594,649.375 2012,649.5313 Q2012.6563,649.6875 2013.2188,649.9844 L2013.2188,652.7031 Q2012.5938,652.125 2012,651.8594 Q2011.4063,651.5781 2010.7813,651.5781 Q2009.4375,651.5781 2008.75,652.6563 Q2008.0625,653.7188 2008.0625,655.8125 Q2008.0625,657.9063 2008.75,658.9844 Q2009.4375,660.0469 2010.7813,660.0469 Q2011.4063,660.0469 2012,659.7813 Q2012.5938,659.5 2013.2188,658.9219 L2013.2188,661.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="2030.75" y="660.1543">AESDecryptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1905" x2="2209" y1="672" y2="672"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1905" x2="2209" y1="680" y2="680"/><ellipse cx="1915" cy="691.9023" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="1924" y="694.2104">AESDecryptor()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1928" y="707.0151"/><ellipse cx="1915" cy="717.5117" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="280" x="1924" y="719.8198">decryptFile(const std::string &amp;bflyFileName): void</text><!--class CryptoRSA--><rect fill="#FEFECE" filter="url(#f1s24aysut7nxx)" height="419.3359" id="CryptoRSA" style="stroke: #A80036; stroke-width: 1.5;" width="932" x="385" y="102"/><ellipse cx="814.75" cy="118" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M817.7188,123.6406 Q817.1406,123.9375 816.5,124.0781 Q815.8594,124.2344 815.1563,124.2344 Q812.6563,124.2344 811.3281,122.5938 Q810.0156,120.9375 810.0156,117.8125 Q810.0156,114.6875 811.3281,113.0313 Q812.6563,111.375 815.1563,111.375 Q815.8594,111.375 816.5,111.5313 Q817.1563,111.6875 817.7188,111.9844 L817.7188,114.7031 Q817.0938,114.125 816.5,113.8594 Q815.9063,113.5781 815.2813,113.5781 Q813.9375,113.5781 813.25,114.6563 Q812.5625,115.7188 812.5625,117.8125 Q812.5625,119.9063 813.25,120.9844 Q813.9375,122.0469 815.2813,122.0469 Q815.9063,122.0469 816.5,121.7813 Q817.0938,121.5 817.7188,120.9219 L817.7188,123.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="835.25" y="122.1543">CryptoRSA</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="386" x2="1316" y1="134" y2="134"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="393" y="142.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="405" y="148.2104">_pkey: EVP_PKEY*</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="393" y="155.707"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="152" x="405" y="161.0151">_keySize, _paddingSize: int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="393" y="168.5117"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="314" x="405" y="173.8198">_rsaPrivateKeyStr, _privateKeyStr, _publicKeyStr: char*</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="393" y="181.3164"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="200" x="405" y="186.6245">_encryptedKey, _iv: unsigned char*</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="393" y="194.1211"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="326" x="405" y="199.4292">rsaEncryptContext, rsaDecryptContext: EVP_CIPHER_CTX*</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="386" x2="1316" y1="206.0234" y2="206.0234"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="393" y="214.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="405" y="220.2339">getOpenSSLError(): string</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="393" y="227.7305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="405" y="233.0386">generateRSAKey(): bool</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="393" y="240.5352"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="281" x="405" y="245.8433">loadKeyFromFile(const std::string &amp;filepath): void</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="393" y="253.3398"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="253" x="405" y="258.6479">loadKeyFromStr(const std::string &amp;str): void</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="393" y="266.1445"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="441" x="405" y="271.4526">validateStringLengthForRSA(const std::string &amp;msg, const int &amp;keysize): bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="409" y="284.2573"/><polygon fill="#FFFF44" points="396,289.7539,400,293.7539,396,297.7539,392,293.7539" style="stroke: #B38D22; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="405" y="297.062">getPaddingSize(): int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="409" y="309.8667"/><ellipse cx="396" cy="320.3633" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="127" x="405" y="322.6714">CryptoRSA(int keySize)</text><ellipse cx="396" cy="333.168" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="194" x="405" y="335.4761">CryptoRSA(const std::string &amp;key)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="409" y="348.2808"/><ellipse cx="396" cy="358.7773" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="188" x="405" y="361.0854">getRSAIV() const: unsigned char*</text><ellipse cx="396" cy="371.582" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="254" x="405" y="373.8901">getRSAEncryptedKey() const: unsigned char*</text><ellipse cx="396" cy="384.3867" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="405" y="386.6948">getEvpPkey(): EVP_PKEY*</text><ellipse cx="396" cy="397.1914" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="405" y="399.4995">getEvpPkeySize(EVP_PKEY *key): int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="409" y="412.3042"/><ellipse cx="396" cy="422.8008" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="163" x="405" y="425.1089">getRSAPrivateKeyStr(): char*</text><ellipse cx="396" cy="435.6055" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="405" y="437.9136">getPrivateKeyStr(): char*</text><ellipse cx="396" cy="448.4102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="135" x="405" y="450.7183">getPublicKeyStr(): char*</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="409" y="463.5229"/><ellipse cx="396" cy="474.0195" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="650" x="405" y="476.3276">encrpytEVP(EVP_PKEY *key, const unsigned char *plaintext, size_t plaintextLength, unsigned char **ciphertext): int</text><ellipse cx="396" cy="486.8242" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="906" x="405" y="489.1323">decryptEVP(EVP_PKEY *key, unsigned char *ciphertext, size_t ciphertextLength, unsigned char *encryptedKey, unsigned char *iv, unsigned char **plaintext): int</text><ellipse cx="396" cy="499.6289" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="623" x="405" y="501.937">encrypt(EVP_PKEY *key, const unsigned char *plaintext, size_t plaintextLength, unsigned char *ciphertext): int</text><ellipse cx="396" cy="512.4336" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="596" x="405" y="514.7417">decrypt(EVP_PKEY *key, unsigned char* ciphertext, size_t ciphertextLength, unsigned char* plaintext): int</text><!--class RSAEncryptor--><rect fill="#FEFECE" filter="url(#f1s24aysut7nxx)" height="201.6563" id="RSAEncryptor" style="stroke: #A80036; stroke-width: 1.5;" width="667" x="169.5" y="582"/><ellipse cx="456.75" cy="598" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M459.7188,603.6406 Q459.1406,603.9375 458.5,604.0781 Q457.8594,604.2344 457.1563,604.2344 Q454.6563,604.2344 453.3281,602.5938 Q452.0156,600.9375 452.0156,597.8125 Q452.0156,594.6875 453.3281,593.0313 Q454.6563,591.375 457.1563,591.375 Q457.8594,591.375 458.5,591.5313 Q459.1563,591.6875 459.7188,591.9844 L459.7188,594.7031 Q459.0938,594.125 458.5,593.8594 Q457.9063,593.5781 457.2813,593.5781 Q455.9375,593.5781 455.25,594.6563 Q454.5625,595.7188 454.5625,597.8125 Q454.5625,599.9063 455.25,600.9844 Q455.9375,602.0469 457.2813,602.0469 Q457.9063,602.0469 458.5,601.7813 Q459.0938,601.5 459.7188,600.9219 L459.7188,603.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="84" x="477.25" y="602.1543">RSAEncryptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="170.5" x2="835.5" y1="614" y2="614"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="177.5" y="622.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="180" x="189.5" y="628.2104">_encryptedMessage: std::string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="170.5" x2="835.5" y1="634.8047" y2="634.8047"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="177.5" y="643.707"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="441" x="189.5" y="649.0151">validateStringLengthForRSA(const std::string &amp;msg, const int &amp;keysize): bool</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="177.5" y="656.5117"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="316" x="189.5" y="661.8198">writeRSAFileToSystem(const RSAKEY_TYPE &amp;type): bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="193.5" y="674.6245"/><ellipse cx="180.5" cy="685.1211" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="189.5" y="687.4292">RSAEncryptor(int keySize)</text><ellipse cx="180.5" cy="697.9258" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="189.5" y="700.2339">RSAEncryptor(const std::string &amp;key)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="193.5" y="713.0386"/><ellipse cx="180.5" cy="723.5352" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="235" x="189.5" y="725.8433">getEncryptedMessage() const: std::string</text><ellipse cx="180.5" cy="736.3398" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="641" x="189.5" y="738.6479">writeEncMSGToFile(const std::string &amp;filename, const std::string &amp;ciphertextMsg, int ciphertextMsgLength): void</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="193.5" y="751.4526"/><ellipse cx="180.5" cy="761.9492" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="325" x="189.5" y="764.2573">encrypt(EVP_PKEY *pkey, const std::string &amp;decMSG): int</text><ellipse cx="180.5" cy="774.7539" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="504" x="189.5" y="777.062">encryptEVP(EVP_PKEY *pkey, const std::string &amp;decMSG, const RSAKEY_TYPE &amp;type): int</text><!--class RSADecryptor--><rect fill="#FEFECE" filter="url(#f1s24aysut7nxx)" height="201.6563" id="RSADecryptor" style="stroke: #A80036; stroke-width: 1.5;" width="657" x="871.5" y="582"/><ellipse cx="1153.25" cy="598" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1156.2188,603.6406 Q1155.6406,603.9375 1155,604.0781 Q1154.3594,604.2344 1153.6563,604.2344 Q1151.1563,604.2344 1149.8281,602.5938 Q1148.5156,600.9375 1148.5156,597.8125 Q1148.5156,594.6875 1149.8281,593.0313 Q1151.1563,591.375 1153.6563,591.375 Q1154.3594,591.375 1155,591.5313 Q1155.6563,591.6875 1156.2188,591.9844 L1156.2188,594.7031 Q1155.5938,594.125 1155,593.8594 Q1154.4063,593.5781 1153.7813,593.5781 Q1152.4375,593.5781 1151.75,594.6563 Q1151.0625,595.7188 1151.0625,597.8125 Q1151.0625,599.9063 1151.75,600.9844 Q1152.4375,602.0469 1153.7813,602.0469 Q1154.4063,602.0469 1155,601.7813 Q1155.5938,601.5 1156.2188,600.9219 L1156.2188,603.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="1173.75" y="602.1543">RSADecryptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="872.5" x2="1527.5" y1="614" y2="614"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="879.5" y="622.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="180" x="891.5" y="628.2104">_decryptedMessage: std::string</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="872.5" x2="1527.5" y1="634.8047" y2="634.8047"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="879.5" y="643.707"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="441" x="891.5" y="649.0151">validateStringLengthForRSA(const std::string &amp;msg, const int &amp;keysize): bool</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="879.5" y="656.5117"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="587" x="891.5" y="661.8198">readRSAFileFromSystem(const RSAKEY_TYPE &amp;rsakeysType, std::string &amp;encKey, std::string &amp;iv): void</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="895.5" y="674.6245"/><ellipse cx="882.5" cy="685.1211" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="891.5" y="687.4292">RSADecryptor() = delete</text><ellipse cx="882.5" cy="697.9258" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="212" x="891.5" y="700.2339">RSADecryptor(const std::string &amp;key)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="895.5" y="713.0386"/><ellipse cx="882.5" cy="723.5352" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="201" x="891.5" y="725.8433">getDecryptedMessage(): std::string</text><ellipse cx="882.5" cy="736.3398" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="345" x="891.5" y="738.6479">readEncMSGFromFile(const std::string &amp;filepath): std::string</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="895.5" y="751.4526"/><ellipse cx="882.5" cy="761.9492" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="325" x="891.5" y="764.2573">decrypt(EVP_PKEY *pkey, const std::string &amp;encMSG): int</text><ellipse cx="882.5" cy="774.7539" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="631" x="891.5" y="777.062">decryptEVP(EVP_PKEY *pkey, const std::string &amp;encMSG, std::string &amp;decMSG, const RSAKEY_TYPE &amp;type): int</text><!--class Encryptor--><rect fill="#FEFECE" filter="url(#f1s24aysut7nxx)" height="252.875" id="Encryptor" style="stroke: #A80036; stroke-width: 1.5;" width="551" x="636.5" y="884"/><ellipse cx="877.75" cy="900" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M880.7188,905.6406 Q880.1406,905.9375 879.5,906.0781 Q878.8594,906.2344 878.1563,906.2344 Q875.6563,906.2344 874.3281,904.5938 Q873.0156,902.9375 873.0156,899.8125 Q873.0156,896.6875 874.3281,895.0313 Q875.6563,893.375 878.1563,893.375 Q878.8594,893.375 879.5,893.5313 Q880.1563,893.6875 880.7188,893.9844 L880.7188,896.7031 Q880.0938,896.125 879.5,895.8594 Q878.9063,895.5781 878.2813,895.5781 Q876.9375,895.5781 876.25,896.6563 Q875.5625,897.7188 875.5625,899.8125 Q875.5625,901.9063 876.25,902.9844 Q876.9375,904.0469 878.2813,904.0469 Q878.9063,904.0469 879.5,903.7813 Q880.0938,903.5 880.7188,902.9219 L880.7188,905.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="898.25" y="904.1543">Encryptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="637.5" x2="1186.5" y1="916" y2="916"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="644.5" y="924.9023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="70" x="656.5" y="930.2104">_keySize: int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="644.5" y="937.707"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="96" x="656.5" y="943.0151">_aesKeyInit: bool</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="644.5" y="950.5117"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="200" x="656.5" y="955.8198">_threads: std::vector&lt;std::thread&gt;</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="644.5" y="963.3164"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="492" x="656.5" y="968.6245">_rsaEncryptorCPrivateRSA, _rsaEncryptorAESKey: std::unique_ptr&lt;rsa::RSAEncryptor&gt;</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="644.5" y="976.1211"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="298" x="656.5" y="981.4292">_aesEncryptor: std::unique_ptr&lt;aes::AESEncryptor&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="637.5" x2="1186.5" y1="988.0234" y2="988.0234"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="644.5" y="996.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="163" x="656.5" y="1002.2339">validateAESKeyLength(): void</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="644.5" y="1009.7305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="407" x="656.5" y="1015.0386">static saveUnencryptedAESKeyPair(const std::string &amp;aesKeyPair): void</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="660.5" y="1027.8433"/><ellipse cx="647.5" cy="1038.3398" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="167" x="656.5" y="1040.6479">Encryptor(int keySize = 2048)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="660.5" y="1053.4526"/><ellipse cx="647.5" cy="1063.9492" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="332" x="656.5" y="1066.2573">invokeDir(const std::string &amp;dirPath, bool protection): void</text><ellipse cx="647.5" cy="1076.7539" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="656.5" y="1079.062">encryptCPrivateRSA(): void</text><ellipse cx="647.5" cy="1089.5586" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="295" x="656.5" y="1091.8667">encryptFileWithAES(const std::string &amp;filepath): void</text><ellipse cx="647.5" cy="1102.3633" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="525" x="656.5" y="1104.6714">encryptFinalAESKeyWithRSA(const std::string &amp;aesKeyStr, const std::string &amp;filename): void</text><ellipse cx="647.5" cy="1115.168" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="266" x="656.5" y="1117.4761">spawnThread(const std::string &amp;filepath): void</text><ellipse cx="647.5" cy="1127.9727" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="656.5" y="1130.2808">joinThreads(): void</text><!--class Decryptor--><rect fill="#FEFECE" filter="url(#f1s24aysut7nxx)" height="240.0703" id="Decryptor" style="stroke: #A80036; stroke-width: 1.5;" width="643" x="1222.5" y="890.5"/><ellipse cx="1509.25" cy="906.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1512.2188,912.1406 Q1511.6406,912.4375 1511,912.5781 Q1510.3594,912.7344 1509.6563,912.7344 Q1507.1563,912.7344 1505.8281,911.0938 Q1504.5156,909.4375 1504.5156,906.3125 Q1504.5156,903.1875 1505.8281,901.5313 Q1507.1563,899.875 1509.6563,899.875 Q1510.3594,899.875 1511,900.0313 Q1511.6563,900.1875 1512.2188,900.4844 L1512.2188,903.2031 Q1511.5938,902.625 1511,902.3594 Q1510.4063,902.0781 1509.7813,902.0781 Q1508.4375,902.0781 1507.75,903.1563 Q1507.0625,904.2188 1507.0625,906.3125 Q1507.0625,908.4063 1507.75,909.4844 Q1508.4375,910.5469 1509.7813,910.5469 Q1510.4063,910.5469 1511,910.2813 Q1511.5938,910 1512.2188,909.4219 L1512.2188,912.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="61" x="1529.75" y="910.6543">Decryptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1223.5" x2="1864.5" y1="922.5" y2="922.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1230.5" y="931.4023"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="252" x="1242.5" y="936.7104">_decryptedCPrivateRSA, _dirPath: std::string</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1230.5" y="944.207"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="200" x="1242.5" y="949.5151">_threads: std::vector&lt;std::thread&gt;</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1230.5" y="957.0117"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="365" x="1242.5" y="962.3198">_rsaDecryptorCPrivateRSA: std::unique_ptr&lt;rsa::RSADecryptor&gt;</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1230.5" y="969.8164"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="300" x="1242.5" y="975.1245">_aesDecryptor: std::unique_ptr&lt;aes::AESDecryptor&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1223.5" x2="1864.5" y1="981.7188" y2="981.7188"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1230.5" y="990.6211"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="200" x="1242.5" y="995.9292">static removeDecryptedFiles(): void</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1230.5" y="1003.4258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="412" x="1242.5" y="1008.7339">static getAESKeyPairFromUnencryptedFile(std::string &amp;aesKeyPair): bool</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1246.5" y="1021.5386"/><ellipse cx="1233.5" cy="1032.0352" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="1242.5" y="1034.3433">Decryptor()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1246.5" y="1047.1479"/><ellipse cx="1233.5" cy="1057.6445" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="448" x="1242.5" y="1059.9526">invokeDir(const std::string &amp;dirPath, const std::string &amp;pkeyFromServer): void</text><ellipse cx="1233.5" cy="1070.4492" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="575" x="1242.5" y="1072.7573">decryptCPrivateRSA(const std::string &amp;pkeyFromServer, const std::string &amp;encCPrivateRSAFile): void</text><ellipse cx="1233.5" cy="1083.2539" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="617" x="1242.5" y="1085.562">decryptAESKeyPair(const std::string &amp;filepathAESKey, std::string &amp;decAESKey,  std::string &amp;decAESIV): void</text><ellipse cx="1233.5" cy="1096.0586" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="529" x="1242.5" y="1098.3667">decryptFileWithAES(const std::string &amp;filepath, std::string &amp;aesKey, std::string &amp;aesIV): void</text><ellipse cx="1233.5" cy="1108.8633" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="266" x="1242.5" y="1111.1714">spawnThread(const std::string &amp;filepath): void</text><ellipse cx="1233.5" cy="1121.668" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="1242.5" y="1123.9761">joinThreads(): void</text><!--entity ##14--><!--entity ##16--><!--entity ##18--><!--link CryptoRSA to RSAEncryptor--><path d="M640.72,535.77 C625.68,551.74 611.02,567.31 597.21,581.97 " fill="none" id="CryptoRSA-RSAEncryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="635.82,530.77,654.63,521.01,646.01,540.37,635.82,530.77" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CryptoRSA to RSADecryptor--><path d="M1061.88,535.77 C1076.97,551.74 1091.67,567.31 1105.52,581.97 " fill="none" id="CryptoRSA-RSADecryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1056.58,540.35,1047.94,521.01,1066.76,530.74,1056.58,540.35" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CryptoAES to AESEncryptor--><path d="M1819,482.04 C1792.13,540.44 1764.32,600.89 1746.41,639.82 " fill="none" id="CryptoAES-AESEncryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1812.77,478.83,1827.49,463.59,1825.49,484.68,1812.77,478.83" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CryptoAES to AESDecryptor--><path d="M1970.41,482.04 C1995.7,540.44 2021.88,600.89 2038.73,639.82 " fill="none" id="CryptoAES-AESDecryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1963.95,484.72,1962.42,463.59,1976.8,479.16,1963.95,484.72" style="stroke: #A80036; stroke-width: 1.0;"/><!--link RSAEncryptor to Encryptor--><path d="M639.07,792.29 C675.91,821.61 716.09,853.59 754.02,883.78 " fill="none" id="RSAEncryptor-Encryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="628.77,784.09,630.9718,790.9568,638.1571,791.5654,635.9554,784.6987,628.77,784.09" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="684" y="829.0669">«uses»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="613.8046" y="803.8089">1..*</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="736.6555" y="873.0948">1</text><!--link AESEncryptor to Encryptor--><path d="M1667.16,734.25 C1633.32,760.13 1589.06,789.96 1545,808 C1487.32,831.62 1468.96,826.19 1407,833 C1362.34,837.9 1248.17,828.55 1205,841 C1169.62,851.2 1133.98,866.53 1100.33,883.85 " fill="none" id="AESEncryptor-Encryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="1677.76,726.01,1670.5676,726.5286,1668.28,733.3672,1675.4724,732.8486,1677.76,726.01" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1523" y="829.0669">«uses»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="1644.6999" y="746.4193">1..*</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="1103.5626" y="872.75">1</text><!--link RSADecryptor to Decryptor--><path d="M1315.67,793.45 C1348.59,824.6 1384.6,858.67 1418.09,890.36 " fill="none" id="RSADecryptor-Decryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="1306.02,784.32,1307.6259,791.35,1314.7328,792.5715,1313.1269,785.5415,1306.02,784.32" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1352" y="829.0669">«uses»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="1289.3706" y="803.7142">1..*</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="1401.7676" y="879.252">1</text><!--link AESDecryptor to Decryptor--><path d="M1990.95,734.14 C1959.63,757.33 1921.4,784.81 1886,808 C1843.77,835.66 1797.71,863.99 1753.47,890.34 " fill="none" id="AESDecryptor-Decryptor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="2001.72,726.13,1994.5185,726.5015,1992.0916,733.292,1999.2931,732.9205,2001.72,726.13" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="1869" y="829.0669">«uses»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="1967.6596" y="746.5592">1..*</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="1757.9908" y="879.6295">1</text><!--
@startuml

package butterfly #AAAAAA
{

package aes #DDDDDD
{
    class CryptoAES
    {
        - _aesEncryptContext, _aesDecryptContext: EVP_CIPHER_CTX*
        - _aesKeyLength, _aesIvLength: int

        # aesKey, aesIv: unsigned char*

        + CryptoAES()

        + initDone(): bool
        + generateAESKey(): bool
        + generateAESKeyWithSalt(): bool

        + setAESKey(std::string &aesKey): void
        + setAESIv(std::string &aesIv): void
        + getAESKey() const: std::string
        + getAESIv() const: std::string
        + getAESKeyPair() const: std::string
        + getAESKeyLength() const: int
        + getAESIVLength() const: int

        + encrypt(const unsigned char *plaintext, size_t plaintextLength, unsigned char **ciphertext): size_t
        + decrypt(unsigned char *ciphertext, size_t ciphertextLength, unsigned char **plaintext): size_t
    }


    class AESEncryptor
    {
        + AESEncryptor()

        + encryptFile(const std::string &filename): void

    }

    class AESDecryptor
    {
        + AESDecryptor()

        + decryptFile(const std::string &bflyFileName): void
    }

}

package rsa #DDDDDD
{
    class CryptoRSA
    {
        - _pkey: EVP_PKEY*
        - _keySize, _paddingSize: int
        - _rsaPrivateKeyStr, _privateKeyStr, _publicKeyStr: char*
        - _encryptedKey, _iv: unsigned char*
        - rsaEncryptContext, rsaDecryptContext: EVP_CIPHER_CTX*

        - getOpenSSLError(): string
        - generateRSAKey(): bool
        - loadKeyFromFile(const std::string &filepath): void
        - loadKeyFromStr(const std::string &str): void
        - validateStringLengthForRSA(const std::string &msg, const int &keysize): bool

        # getPaddingSize(): int

        + CryptoRSA(int keySize)
        + CryptoRSA(const std::string &key)

        + getRSAIV() const: unsigned char*
        + getRSAEncryptedKey() const: unsigned char*
        + getEvpPkey(): EVP_PKEY*
        + getEvpPkeySize(EVP_PKEY *key): int

        + getRSAPrivateKeyStr(): char*
        + getPrivateKeyStr(): char*
        + getPublicKeyStr(): char*

        + encrpytEVP(EVP_PKEY *key, const unsigned char *plaintext, size_t plaintextLength, unsigned char **ciphertext): int
        + decryptEVP(EVP_PKEY *key, unsigned char *ciphertext, size_t ciphertextLength, unsigned char *encryptedKey, unsigned char *iv, unsigned char **plaintext): int
        + encrypt(EVP_PKEY *key, const unsigned char *plaintext, size_t plaintextLength, unsigned char *ciphertext): int
        + decrypt(EVP_PKEY *key, unsigned char* ciphertext, size_t ciphertextLength, unsigned char* plaintext): int
    }

    class RSAEncryptor
    {
        - _encryptedMessage: std::string

        - validateStringLengthForRSA(const std::string &msg, const int &keysize): bool
        - writeRSAFileToSystem(const RSAKEY_TYPE &type): bool

        + RSAEncryptor(int keySize)
        + RSAEncryptor(const std::string &key)

        + getEncryptedMessage() const: std::string
        + writeEncMSGToFile(const std::string &filename, const std::string &ciphertextMsg, int ciphertextMsgLength): void

        + encrypt(EVP_PKEY *pkey, const std::string &decMSG): int
        + encryptEVP(EVP_PKEY *pkey, const std::string &decMSG, const RSAKEY_TYPE &type): int
    }

    class RSADecryptor
    {
        - _decryptedMessage: std::string

        - validateStringLengthForRSA(const std::string &msg, const int &keysize): bool
        - readRSAFileFromSystem(const RSAKEY_TYPE &rsakeysType, std::string &encKey, std::string &iv): void

        + RSADecryptor() = delete
        + RSADecryptor(const std::string &key)

        + getDecryptedMessage(): std::string
        + readEncMSGFromFile(const std::string &filepath): std::string

        + decrypt(EVP_PKEY *pkey, const std::string &encMSG): int
        + decryptEVP(EVP_PKEY *pkey, const std::string &encMSG, std::string &decMSG, const RSAKEY_TYPE &type): int
    }

}

package hybrid #DDDDDD
{
    class Encryptor
    {
        - _keySize: int
        - _aesKeyInit: bool
        - _threads: std::vector<std::thread>
        - _rsaEncryptorCPrivateRSA, _rsaEncryptorAESKey: std::unique_ptr<rsa::RSAEncryptor>
        - _aesEncryptor: std::unique_ptr<aes::AESEncryptor>

        - validateAESKeyLength(): void
        - static saveUnencryptedAESKeyPair(const std::string &aesKeyPair): void

        + Encryptor(int keySize = 2048)

        + invokeDir(const std::string &dirPath, bool protection): void
        + encryptCPrivateRSA(): void
        + encryptFileWithAES(const std::string &filepath): void
        + encryptFinalAESKeyWithRSA(const std::string &aesKeyStr, const std::string &filename): void
        + spawnThread(const std::string &filepath): void
        + joinThreads(): void
    }

    class Decryptor
    {
        - _decryptedCPrivateRSA, _dirPath: std::string
        - _threads: std::vector<std::thread>
        - _rsaDecryptorCPrivateRSA: std::unique_ptr<rsa::RSADecryptor>
        - _aesDecryptor: std::unique_ptr<aes::AESDecryptor>

        - static removeDecryptedFiles(): void
        - static getAESKeyPairFromUnencryptedFile(std::string &aesKeyPair): bool

        + Decryptor()

        + invokeDir(const std::string &dirPath, const std::string &pkeyFromServer): void
        + decryptCPrivateRSA(const std::string &pkeyFromServer, const std::string &encCPrivateRSAFile): void
        + decryptAESKeyPair(const std::string &filepathAESKey, std::string &decAESKey,  std::string &decAESIV): void
        + decryptFileWithAES(const std::string &filepath, std::string &aesKey, std::string &aesIV): void
        + spawnThread(const std::string &filepath): void
        + joinThreads(): void
    }
}

together {
  class CryptoRSA
  class CryptoAES
}

together {
class RSAEncryptor
class RSADecryptor
class AESEncryptor
class AESDecryptor
}

together {
  class Encryptor
  class Decryptor
}

CryptoRSA <|- - RSAEncryptor
CryptoRSA <|- - RSADecryptor

CryptoAES <|- - AESEncryptor
CryptoAES <|- - AESDecryptor

RSAEncryptor "1..*" o- - "1" Encryptor: <<uses>>
AESEncryptor "1..*" o- - "1" Encryptor: <<uses>>

RSADecryptor "1..*" o- - "1" Decryptor: <<uses>>
AESDecryptor "1..*" o- - "1" Decryptor: <<uses>>

}
@enduml

PlantUML version 1.2018.13(Mon Nov 26 18:11:51 CET 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.11+9-Ubuntu-0ubuntu2.20.04
Operating System: Linux
OS Version: 5.11.0-38-generic
Default Encoding: UTF-8
Language: de
Country: DE
--></g></svg>