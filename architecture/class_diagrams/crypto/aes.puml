@startuml

package butterfly #AAAAAA
{

package aes #DDDDDD
{

class CryptoAES
{
    - _aesEncryptContext, _aesDecryptContext: EVP_CIPHER_CTX*
    - _aesKeyLength, _aesIvLength: int

    # aesKey, aesIv: unsigned char*

    + CryptoAES()

    + initDone(): bool
    + generateAESKey(): bool
    + generateAESKeyWithSalt(): bool

    + setAESKey(std::string &aesKey): void
    + setAESIv(std::string &aesIv): void
    + getAESKey() const: std::string
    + getAESIv() const: std::string
    + getAESKeyPair() const: std::string
    + getAESKeyLength() const: int
    + getAESIVLength() const: int

    + encrypt(const unsigned char *plaintext, size_t plaintextLength, unsigned char **ciphertext): size_t
    + decrypt(unsigned char *ciphertext, size_t ciphertextLength, unsigned char **plaintext): size_t
}

class AESEncryptor
{
    + AESEncryptor()

    + encryptFile(const std::string &filename): void

}

class AESDecryptor
{
    + AESDecryptor()

    + decryptFile(const std::string &bflyFileName): void
}

CryptoAES <|-- AESEncryptor
CryptoAES <|-- AESDecryptor

}

}
@enduml